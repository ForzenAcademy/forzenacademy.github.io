{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://forzen-core/./src/ui/dialog/SelectionDialog.ts","webpack://forzen-core/./src/ui/dialog/ScrollableSelectionDialog.ts","webpack://forzen-core/./src/game/component/DestroyTimer.ts","webpack://forzen-core/./src/graphics/Camera.ts","webpack://forzen-core/./src/game/BackgroundData.ts","webpack://forzen-core/./src/graphics/CanvasRenderer.ts","webpack://forzen-core/./src/ui/Alignment.ts","webpack://forzen-core/./src/audio/AudioParser.ts","webpack://forzen-core/./src/physics/Point.ts","webpack://forzen-core/./src/ui/components/SelectionCarousel.ts","webpack://forzen-core/./src/ui/DialogList.ts","webpack://forzen-core/./src/game/Game.ts","webpack://forzen-core/./src/text/Font.ts","webpack://forzen-core/./src/text/TextUtil.ts","webpack://forzen-core/./src/audio/Audio.ts","webpack://forzen-core/./src/ui/dialog/AlertChoiceDialog.ts","webpack://forzen-core/./src/graphics/Animation.ts","webpack://forzen-core/./src/game/Joystick.ts","webpack://forzen-core/./src/game/Input.ts","webpack://forzen-core/./src/graphics/ColorLightMap.ts","webpack://forzen-core/./src/physics/Direction.ts","webpack://forzen-core/./src/ui/dialog/Dialog.ts","webpack://forzen-core/./src/graphics/RgbColor.ts","webpack://forzen-core/./src/physics/Collision.ts","webpack://forzen-core/./src/graphics/Bitmap.ts","webpack://forzen-core/./src/game/Decoration.ts","webpack://forzen-core/./src/assets/DefaultAssets.ts","webpack://forzen-core/./src/graphics/Pixels.ts","webpack://forzen-core/./src/graphics/GraphicsProperties.ts","webpack://forzen-core/./src/game/GameDriver.ts","webpack://forzen-core/./src/game/Timer.ts","webpack://forzen-core/./src/graphics/GameGraphics.ts","webpack://forzen-core/./src/audio/Note.ts","webpack://forzen-core/./src/game/GameObject.ts","webpack://forzen-core/./src/util/Random.ts","webpack://forzen-core/./src/physics/Vector.ts","webpack://forzen-core/./src/ui/components/Cursor.ts","webpack://forzen-core/./src/util/TimeUtil.ts","webpack://forzen-core/./src/assets/Assets.ts","webpack://forzen-core/./src/graphics/ColorFilter.ts","webpack://forzen-core/./src/ui/dialog/ListAlertDialog.ts","webpack://forzen-core/./src/audio/Instrument.ts","webpack://forzen-core/./src/index.ts","webpack://forzen-core/./src/game/Component.ts","webpack://forzen-core/./src/ui/dialog/DialogStack.ts","webpack://forzen-core/./src/game/BuildConfig.ts","webpack://forzen-core/./src/game/Scene.ts","webpack://forzen-core/./src/game/Lifecycle.ts","webpack://forzen-core/./src/ui/dialog/SelectionCarouselDialog.ts","webpack://forzen-core/./src/util/ListUtil.ts","webpack://forzen-core/./src/ui/dialog/AlertDialog.ts","webpack://forzen-core/./src/util/MathUtil.ts","webpack://forzen-core/webpack/bootstrap","webpack://forzen-core/webpack/startup"],"sourcesContent":["import { INPUT } from '../../game/Input';\nimport { Lifecycle } from '../../game/Lifecycle';\nimport { Bitmap } from '../../graphics/Bitmap';\nimport { CanvasRenderer } from '../../graphics/CanvasRenderer';\nimport { Font } from '../../text/Font';\nimport { SelectCursor } from '../components/Cursor';\nimport { List, ListItem } from '../DialogList';\nimport { Dialog } from './Dialog';\n\nexport class SelectionDialog extends Lifecycle {\n  private dialog: Dialog;\n  private list: List;\n  private scursor = new SelectCursor();\n  private cursorIndex = 0;\n  public showCursor = true;\n\n  constructor(\n    public onSelect: (index: number) => void,\n    public onDismiss: () => void,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    topLeftCorner: Bitmap,\n    verticalSidePiece: Bitmap,\n    public labels: ListItem[],\n    public font: Font,\n    public kerning: number,\n    public lineHeight: number,\n  ) {\n    super();\n    this.dialog = new Dialog(x, y, width, height, topLeftCorner, verticalSidePiece);\n    this.list = new List(labels);\n  }\n\n  public reset(): void {\n    this.cursorIndex = 0;\n  }\n\n  update = () => {\n    this.scursor.update();\n    if (INPUT.getKeyDown('down')) {\n      do {\n        this.cursorIndex += 1;\n        if (this.cursorIndex >= this.labels.length) {\n          this.cursorIndex = 0;\n        }\n      } while (!this.labels[this.cursorIndex].selectable);\n    } else if (INPUT.getKeyDown('up')) {\n      do {\n        this.cursorIndex -= 1;\n        if (this.cursorIndex < 0) {\n          this.cursorIndex = this.labels.length - 1;\n        }\n      } while (!this.labels[this.cursorIndex].selectable);\n    }\n    if (INPUT.getKeyDown('A')) {\n      this.onSelect(this.cursorIndex);\n    } else if (INPUT.getKeyDown('B')) {\n      this.onDismiss();\n    }\n  };\n\n  drawUi = (r: CanvasRenderer) => {\n    this.dialog.drawUi(r);\n    const cursorPadding = 9;\n    const context = this.dialog.getRenderContext(cursorPadding);\n    this.list.draw(r, context, this.font, this.kerning, this.lineHeight);\n    const cursorB = this.scursor.get();\n    r.drawStaticBitmap(\n      context.startX - cursorPadding,\n      context.startY + this.lineHeight * this.cursorIndex - 1,\n      cursorB,\n    );\n  };\n}\n","import { INPUT } from '../../game/Input';\nimport { Lifecycle } from '../../game/Lifecycle';\nimport { Bitmap } from '../../graphics/Bitmap';\nimport { CanvasRenderer } from '../../graphics/CanvasRenderer';\nimport { Font } from '../../text/Font';\nimport { MathUtil } from '../../util/MathUtil';\nimport { Alignment } from '../Alignment';\nimport { SelectCursor } from '../components/Cursor';\nimport { ListItem, ScrollableList } from '../DialogList';\nimport { Dialog } from './Dialog';\n\nexport class ScrollableSelectionDialog extends Lifecycle {\n  private dialog: Dialog;\n  private list: ScrollableList;\n  private scursor = new SelectCursor();\n  private cursorIndex = 0;\n  private renderCursorIndex = 0;\n  public showCursor = true;\n\n  constructor(\n    public onSelect: (index: number) => void,\n    public onDismiss: () => void,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    topLeftCorner: Bitmap,\n    verticalSidePiece: Bitmap,\n    public labels: ListItem[],\n    public font: Font,\n    public kerning: number,\n    public lineSpacing: number,\n    maxRowCount: number,\n    public indicatorAlignment: Alignment,\n  ) {\n    super();\n    this.dialog = new Dialog(x, y, width, height, topLeftCorner, verticalSidePiece);\n    this.list = new ScrollableList(labels, maxRowCount);\n  }\n\n  public reset(): void {\n    this.cursorIndex = 0;\n    this.renderCursorIndex = 0;\n    this.list.topOffset = 0;\n  }\n\n  update = () => {\n    this.scursor.update();\n    this.list.update();\n\n    let targetIndex = this.cursorIndex;\n    if (INPUT.getKeyDown('down')) {\n      for (let i = this.cursorIndex + 1; i < this.labels.length; i++) {\n        if (this.labels[i].selectable) {\n          targetIndex = i;\n          break;\n        }\n      }\n    } else if (INPUT.getKeyDown('up')) {\n      for (let i = this.cursorIndex - 1; i >= 0; i--) {\n        if (this.labels[i].selectable) {\n          targetIndex = i;\n          break;\n        }\n      }\n    }\n\n    // Cursor and offset calculations\n    if (this.cursorIndex != targetIndex) {\n      const dir = this.cursorIndex < targetIndex ? 1 : -1;\n      while (this.cursorIndex != targetIndex) {\n        this.cursorIndex += dir;\n        this.cursorIndex = MathUtil.clamp(this.cursorIndex, 0, this.labels.length - 1);\n        const calc = this.calculateRenderCursorIndexTopOffset(\n          this.cursorIndex,\n          this.list.topOffset,\n          this.list.maxRowCount,\n          this.labels.length,\n        );\n        this.renderCursorIndex = calc.renderCursorIndex;\n        this.list.topOffset = calc.topOffset;\n      }\n    }\n\n    if (INPUT.getKeyDown('A')) {\n      this.onSelect(this.cursorIndex);\n    } else if (INPUT.getKeyDown('B')) {\n      this.onDismiss();\n    }\n  };\n\n  private calculateRenderCursorIndexTopOffset(\n    cursorIndex: number,\n    topOffset: number,\n    maxRowCount: number,\n    labelCount: number,\n  ): { renderCursorIndex: number; topOffset: number } {\n    const newRenderCursor = this.calculateNewRenderCursor(\n      cursorIndex,\n      topOffset,\n      maxRowCount,\n      labelCount,\n    );\n    const newTopOffset = cursorIndex - newRenderCursor;\n    return { renderCursorIndex: newRenderCursor, topOffset: newTopOffset };\n  }\n\n  private calculateNewRenderCursor(\n    cursorIndex: number,\n    topOffset: number,\n    maxRowCount: number,\n    labelCount: number,\n  ): number {\n    let newRenderCursor = cursorIndex - topOffset;\n    if (newRenderCursor == 0) newRenderCursor = 1;\n    if (newRenderCursor >= maxRowCount - 1) newRenderCursor = maxRowCount - 2;\n    if (cursorIndex == 0 && topOffset == 0) newRenderCursor = 0;\n    if (cursorIndex == labelCount - 1) newRenderCursor = maxRowCount - 1;\n    return newRenderCursor;\n  }\n\n  drawUi = (r: CanvasRenderer) => {\n    this.dialog.drawUi(r);\n    const cursorPadding = 9;\n    const context = this.dialog.getRenderContext(cursorPadding);\n    this.list.drawList(\n      r,\n      context,\n      this.font,\n      this.kerning,\n      this.lineSpacing,\n      this.indicatorAlignment,\n    );\n    if (this.showCursor) {\n      const cursorB = this.scursor.get();\n      r.drawStaticBitmap(\n        context.startX - cursorPadding,\n        context.startY + this.lineSpacing * this.renderCursorIndex,\n        cursorB,\n      );\n    }\n  };\n}\n","import { Component } from '../Component';\nimport { GameObject } from '../GameObject';\n\nexport class DestroyTimer extends Component {\n  framesLeft: number;\n  constructor(public readonly frames: number) {\n    super();\n    this.framesLeft = frames;\n  }\n\n  update = () => {\n    this.framesLeft -= 1;\n    if (this.framesLeft == 0) {\n      GameObject.destroy(this.gameObject);\n    }\n  };\n}\n","export class Camera {\n  constructor(\n    public width: number,\n    public height: number,\n    public x: number = 0,\n    public y: number = 0,\n  ) {}\n}\n\nexport const CAMERA = new Camera(0, 0);\n","import { Assets } from '../assets/Assets';\nimport { AnimationKeySequence } from '../graphics/Animation';\nimport { Bitmap } from '../graphics/Bitmap';\nimport { Box } from '../physics/Box';\n\nexport class BackgroundData {\n  constructor(\n    public tileWidth: number,\n    public tileHeight: number,\n    public tileDataMap: (BackgroundTile | null)[],\n    public colliders: Box[],\n  ) {}\n}\n\nexport abstract class BackgroundTile {\n  abstract getBitmap(): Bitmap;\n}\n\nexport class NormalBackgroundTile extends BackgroundTile {\n  constructor(public imgName: string) {\n    super();\n  }\n  getBitmap(): Bitmap {\n    return Assets.getBitmapByName(this.imgName);\n  }\n}\n\nexport class AnimatedBackgroundTile extends BackgroundTile {\n  private animation?: AnimationKeySequence;\n\n  constructor(animationName: string) {\n    super();\n    this.animation = Assets.getAnimationByName(animationName);\n  }\n  getBitmap(): Bitmap {\n    const b = this.animation?.get();\n    this.animation?.update();\n    if (!b) throw \"Can't get bitmap for animation!\";\n    return b;\n  }\n}\n","import { Font } from '../text/Font';\nimport { Bitmap } from './Bitmap';\nimport { CAMERA } from './Camera';\nimport { ColorFilter } from './ColorFilter';\nimport { ColorLightMap } from './ColorLightMap';\nimport { GraphicsProperties } from './GraphicsProperties';\nimport { Pixels } from './Pixels';\nimport { RgbColor } from './RgbColor';\n\nexport class CanvasRenderer {\n  public properties: GraphicsProperties;\n\n  private pixels: Pixels;\n  private cachedRgbArray: Uint8ClampedArray = new Uint8ClampedArray();\n  private offscreenCanvas = document.createElement('canvas');\n  private offscreenCtx = this.offscreenCanvas.getContext('2d');\n  private imageData: ImageData;\n  private canvas: HTMLCanvasElement;\n  private colorLightMap?: ColorLightMap = undefined;\n\n  constructor(properties: GraphicsProperties, canvas: HTMLCanvasElement) {\n    this.canvas = canvas;\n    this.properties = properties;\n    this.offscreenCanvas.width = this.properties.width;\n    this.offscreenCanvas.height = this.properties.height;\n\n    this.pixels = new Pixels(properties);\n    this.recalculate();\n    this.imageData = new ImageData(\n      this.cachedRgbArray,\n      this.properties.width,\n      this.properties.height,\n    );\n  }\n\n  public setColorLightMap(colorLightMap: ColorLightMap) {\n    this.colorLightMap = colorLightMap;\n  }\n\n  public render(): void {\n    // TODO don't reallocate, just reassign\n    if (this.pixels.isDirty()) {\n      this.pixels.setClean();\n      this.recalculate();\n    }\n\n    if (this.offscreenCtx) {\n      this.offscreenCtx.putImageData(this.imageData, 0, 0);\n\n      // TODO cache this\n      const ctx = this.canvas.getContext('2d');\n      if (ctx) {\n        ctx.imageSmoothingEnabled = false;\n        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n        const scaleFactorX = this.canvas.width / this.properties.width;\n        const scaleFactorY = this.canvas.height / this.properties.height;\n        ctx.drawImage(\n          this.offscreenCanvas,\n          0,\n          0,\n          this.properties.width * scaleFactorX,\n          this.properties.height * scaleFactorY,\n        );\n      }\n    }\n  }\n\n  private recalculate(): void {\n    this.cachedRgbArray = this.pixels.toRgbaArray();\n    this.imageData = new ImageData(\n      this.cachedRgbArray,\n      this.properties.width,\n      this.properties.height,\n    );\n  }\n\n  public drawBitmap(x: number, y: number, bitmap: Bitmap, filter: ColorFilter | null = null): void {\n    let savedFilter: ColorFilter | null = bitmap.filter;\n    if (filter != null) {\n      savedFilter = bitmap.filter;\n      bitmap.filter = filter;\n    }\n    this.pixels.drawBitmap(x - CAMERA.x, y - CAMERA.y, bitmap);\n    bitmap.filter = savedFilter;\n  }\n\n  public drawLightBitmap(x: number, y: number, intensity: number, bitmap: Bitmap): void {\n    if (this.colorLightMap) {\n      this.pixels.drawLightBitmap(\n        x - CAMERA.x,\n        y - CAMERA.y,\n        intensity,\n        bitmap,\n        this.colorLightMap,\n      );\n    }\n  }\n\n  public drawBitmapCentered(\n    x: number,\n    y: number,\n    bitmap: Bitmap,\n    filter: ColorFilter | null = null,\n  ): void {\n    let savedFilter: ColorFilter | null = bitmap.filter;\n    if (filter != null) {\n      savedFilter = bitmap.filter;\n      bitmap.filter = filter;\n    }\n    this.pixels.drawBitmap(\n      x - CAMERA.x - bitmap.width / 2,\n      y - CAMERA.y - bitmap.height / 2,\n      bitmap,\n    );\n    bitmap.filter = savedFilter;\n  }\n\n  public drawLightBitmapCentered(x: number, y: number, intensity: number, bitmap: Bitmap): void {\n    if (this.colorLightMap) {\n      this.pixels.drawLightBitmap(\n        x - CAMERA.x - bitmap.width / 2,\n        y - CAMERA.y - bitmap.height / 2,\n        intensity,\n        bitmap,\n        this.colorLightMap,\n      );\n    }\n  }\n\n  public drawStaticBitmap(\n    x: number,\n    y: number,\n    bitmap: Bitmap,\n    filter: ColorFilter | null = null,\n  ): void {\n    let savedFilter: ColorFilter | null = bitmap.filter;\n    if (filter != null) {\n      savedFilter = bitmap.filter;\n      bitmap.filter = filter;\n    }\n    this.pixels.drawBitmap(x, y, bitmap);\n    bitmap.filter = savedFilter;\n  }\n\n  public drawStaticBitmapCentered(\n    x: number,\n    y: number,\n    bitmap: Bitmap,\n    filter: ColorFilter | null = null,\n  ): void {\n    let savedFilter: ColorFilter | null = bitmap.filter;\n    if (filter != null) {\n      savedFilter = bitmap.filter;\n      bitmap.filter = filter;\n    }\n    this.pixels.drawBitmap(x - bitmap.width / 2, y - bitmap.width / 2, bitmap);\n    bitmap.filter = savedFilter;\n  }\n\n  public drawText(\n    text: string,\n    x: number,\n    y: number,\n    font: Font,\n    kerning = 0,\n    filter: ColorFilter | null = null,\n  ): void {\n    x -= CAMERA.x;\n    y -= CAMERA.y;\n    for (const c of text) {\n      const l = font.get(c);\n      const oldFilter = l.filter;\n      if (filter != null) {\n        l.filter = filter;\n      }\n      this.pixels.drawBitmap(x, y, l);\n      if (filter != null) {\n        l.filter = oldFilter;\n      }\n      x += l.width + kerning;\n    }\n  }\n\n  public drawStaticText(\n    text: string,\n    x: number,\n    y: number,\n    font: Font,\n    kerning = 0,\n    filter: ColorFilter | null = null,\n  ): void {\n    for (const c of text) {\n      const l = font.get(c);\n      const oldFilter = l.filter;\n      if (filter != null) {\n        l.filter = filter;\n      }\n      this.pixels.drawBitmap(x, y, l);\n      if (filter != null) {\n        l.filter = oldFilter;\n      }\n      x += l.width + kerning;\n    }\n  }\n\n  public drawLightText(\n    text: string,\n    x: number,\n    y: number,\n    font: Font,\n    kerning = 0,\n    intensity: number,\n  ): void {\n    if (this.colorLightMap) {\n      x -= CAMERA.x;\n      y -= CAMERA.y;\n      for (const c of text) {\n        const l = font.get(c);\n        this.pixels.drawLightBitmap(x, y, intensity, l, this.colorLightMap);\n        x += l.width + kerning;\n      }\n    }\n  }\n\n  public drawStaticLightText(\n    text: string,\n    x: number,\n    y: number,\n    font: Font,\n    kerning = 0,\n    intensity: number,\n  ): void {\n    if (this.colorLightMap) {\n      for (const c of text) {\n        const l = font.get(c);\n        this.pixels.drawLightBitmap(x, y, intensity, l, this.colorLightMap);\n        x += l.width + kerning;\n      }\n    }\n  }\n\n  public drawTextWrapping(\n    text: string,\n    x: number,\n    y: number,\n    maxWidth: number,\n    font: Font,\n    kerning = 0,\n    lineSpacing = 0,\n  ): void {\n    this.drawStaticTextWrapping(\n      text,\n      x - CAMERA.x,\n      y - CAMERA.y,\n      maxWidth,\n      font,\n      kerning,\n      lineSpacing,\n    );\n  }\n\n  public drawStaticTextWrapping(\n    text: string,\n    x: number,\n    y: number,\n    maxWidth: number,\n    font: Font,\n    kerning = 0,\n    lineSpacing = 0,\n  ): void {\n    // Split the text into segments at spaces, commas, and periods\n    // The parentheses in the regular expression keep the delimiters in the result\n    const segments = text.split(/([ ,.])/);\n    let currentLine = '';\n    let lineY = y;\n    let segmentIndex = 0;\n\n    while (segmentIndex < segments.length) {\n      const nextSegment = segments[segmentIndex];\n      const nextLine = currentLine + nextSegment;\n\n      // Measure the width of the next line of text\n      const nextLineWidth = font.measure(nextLine, kerning).width;\n\n      // If the next line fits within maxWidth, add the segment to the current line\n      if (nextLineWidth <= maxWidth) {\n        currentLine = nextLine;\n        segmentIndex++;\n      } else if (currentLine === '') {\n        // Handle the case where the first word is wider than maxWidth\n        // Draw the first segment and move to the next line\n        this.drawStaticText(nextSegment.trim(), x, lineY, font, kerning);\n        segmentIndex++;\n        lineY += font.measure(nextSegment, kerning).height;\n      } else {\n        // Otherwise, draw the current line and start a new line\n        this.drawStaticText(currentLine.trim(), x, lineY, font, kerning);\n        currentLine = nextSegment;\n        segmentIndex++;\n        lineY += font.measure(currentLine, kerning).height + lineSpacing;\n      }\n    }\n\n    // Draw any remaining text\n    if (currentLine.trim() !== '') {\n      this.drawStaticText(currentLine.trim(), x, lineY, font, kerning);\n    }\n  }\n\n  public clear(): void {\n    this.pixels.clear();\n  }\n\n  public strokeStaticRectangle(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    color: RgbColor,\n    thickness = 1,\n    cornerRadius = 0,\n  ): void {\n    this.pixels.strokeRectangle(x, y, width, height, color, thickness, cornerRadius);\n  }\n\n  public strokeRectangle(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    color: RgbColor,\n    thickness = 1,\n  ): void {\n    this.pixels.strokeRectangle(x - CAMERA.x, y - CAMERA.y, width, height, color, thickness);\n  }\n\n  public fillStaticRectangle(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    color: RgbColor,\n  ): void {\n    this.pixels.fillRectangle(x, y, width, height, color);\n  }\n\n  public fillRectangle(x: number, y: number, width: number, height: number, color: RgbColor): void {\n    this.pixels.fillRectangle(x - CAMERA.x, y - CAMERA.y, width, height, color);\n  }\n\n  public fillStaticLightRectangle(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    intensity: number,\n  ): void {\n    if (this.colorLightMap) {\n      this.pixels.fillLightRectangle(x, y, width, height, intensity, this.colorLightMap);\n    }\n  }\n\n  public fillLightRectangle(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    intensity: number,\n  ): void {\n    if (this.colorLightMap) {\n      this.pixels.fillLightRectangle(\n        x - CAMERA.x,\n        y - CAMERA.y,\n        width,\n        height,\n        intensity,\n        this.colorLightMap,\n      );\n    }\n  }\n\n  public strokeStaticCircle(\n    x: number,\n    y: number,\n    radius: number,\n    color: RgbColor,\n    thickness = 1,\n  ): void {\n    this.pixels.strokeCircle(x, y, radius, color, thickness);\n  }\n\n  public strokeCircle(x: number, y: number, radius: number, color: RgbColor, thickness = 1): void {\n    this.pixels.strokeCircle(x - CAMERA.x, y - CAMERA.y, radius, color, thickness);\n  }\n\n  public strokeLightCircle(\n    x: number,\n    y: number,\n    radius: number,\n    intensity: number,\n    thickness = 1,\n  ): void {\n    if (this.colorLightMap) {\n      this.pixels.strokeLightCircle(\n        x - CAMERA.x,\n        y - CAMERA.y,\n        radius,\n        intensity,\n        this.colorLightMap,\n        thickness,\n      );\n    }\n  }\n\n  public strokeStaticArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    color: RgbColor,\n    thickness = 1,\n  ): void {\n    this.pixels.strokeArc(x, y, radius, startAngle, endAngle, color, thickness);\n  }\n\n  public strokeArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    color: RgbColor,\n    thickness = 1,\n  ): void {\n    this.pixels.strokeArc(\n      x - CAMERA.x,\n      y - CAMERA.y,\n      radius,\n      startAngle,\n      endAngle,\n      color,\n      thickness,\n    );\n  }\n\n  public fillArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    color: RgbColor,\n  ) {\n    this.pixels.fillArc(x - CAMERA.x, y - CAMERA.y, radius, startAngle, endAngle, color);\n  }\n\n  public fillStaticArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    color: RgbColor,\n  ) {\n    this.pixels.fillArc(x, y, radius, startAngle, endAngle, color);\n  }\n\n  public fillStaticCircle(x: number, y: number, radius: number, color: RgbColor): void {\n    this.pixels.fillCircle(x, y, radius, color);\n  }\n\n  public fillCircle(x: number, y: number, radius: number, color: RgbColor): void {\n    this.pixels.fillCircle(x - CAMERA.x, y - CAMERA.y, radius, color);\n  }\n\n  public fillLightCircle(x: number, y: number, radius: number, intensity: number): void {\n    if (this.colorLightMap) {\n      this.pixels.fillLightCircle(\n        x - CAMERA.x,\n        y - CAMERA.y,\n        radius,\n        intensity,\n        this.colorLightMap,\n      );\n    }\n  }\n\n  public fillStaticLightCircle(x: number, y: number, radius: number, intensity: number): void {\n    if (this.colorLightMap) {\n      this.pixels.fillLightCircle(x, y, radius, intensity, this.colorLightMap);\n    }\n  }\n\n  public strokeStaticOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    color: RgbColor,\n    thickness: number = 1,\n  ): void {\n    this.pixels.strokeOval(xCenter, yCenter, radiusX, radiusY, color, thickness);\n  }\n\n  public fillStaticOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    color: RgbColor,\n  ): void {\n    this.pixels.fillOval(xCenter, yCenter, radiusX, radiusY, color);\n  }\n\n  public strokeOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    color: RgbColor,\n    thickness: number = 1,\n  ): void {\n    this.pixels.strokeOval(\n      xCenter - CAMERA.x,\n      yCenter - CAMERA.y,\n      radiusX,\n      radiusY,\n      color,\n      thickness,\n    );\n  }\n\n  public fillOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    color: RgbColor,\n  ): void {\n    this.pixels.fillOval(xCenter - CAMERA.x, yCenter - CAMERA.y, radiusX, radiusY, color);\n  }\n\n  public strokeLightOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    intensity: number,\n    thickness: number = 1,\n  ): void {\n    if (this.colorLightMap) {\n      this.pixels.strokeLightOval(\n        xCenter - CAMERA.x,\n        yCenter - CAMERA.y,\n        radiusX,\n        radiusY,\n        intensity,\n        this.colorLightMap,\n        thickness,\n      );\n    }\n  }\n\n  public strokeStaticLightOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    intensity: number,\n    thickness: number = 1,\n  ): void {\n    if (this.colorLightMap) {\n      this.pixels.strokeLightOval(\n        xCenter,\n        yCenter,\n        radiusX,\n        radiusY,\n        intensity,\n        this.colorLightMap,\n        thickness,\n      );\n    }\n  }\n\n  public fillLightOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    intensity: number,\n  ): void {\n    if (this.colorLightMap) {\n      this.pixels.fillLightOval(\n        xCenter - CAMERA.x,\n        yCenter - CAMERA.y,\n        radiusX,\n        radiusY,\n        intensity,\n        this.colorLightMap,\n      );\n    }\n  }\n\n  public fillStaticLightOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    intensity: number,\n  ): void {\n    if (this.colorLightMap) {\n      this.pixels.fillLightOval(xCenter, yCenter, radiusX, radiusY, intensity, this.colorLightMap);\n    }\n  }\n\n  public fillColor(color: RgbColor): void {\n    this.pixels.fillColor(color.copy());\n  }\n\n  public setStaticPixel(x: number, y: number, color: RgbColor): void {\n    this.pixels.setPixel(x, y, color.copy());\n  }\n\n  public setPixel(x: number, y: number, color: RgbColor): void {\n    if (color) {\n      this.pixels.setPixel(x - CAMERA.x, y - CAMERA.y, color.copy());\n    }\n  }\n\n  public drawStaticLine(\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    color: RgbColor,\n    thickness = 1,\n  ): void {\n    this.pixels.drawLine(\n      Math.round(x1),\n      Math.round(y1),\n      Math.round(x2),\n      Math.round(y2),\n      color.copy(),\n      thickness,\n    );\n  }\n\n  public drawLine(\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    color: RgbColor,\n    thickness = 1,\n  ): void {\n    this.pixels.drawLine(\n      Math.round(x1 - CAMERA.x),\n      Math.round(y1 - CAMERA.y),\n      Math.round(x2 - CAMERA.x),\n      Math.round(y2 - CAMERA.y),\n      color.copy(),\n      thickness,\n    );\n  }\n\n  public getPixelData(): Pixels {\n    return this.pixels;\n  }\n}\n","export enum Alignment {\n  LEFT,\n  CENTER,\n  RIGHT,\n  TOP,\n  BOTTOM,\n}\n","import { TextUtil } from '../text/TextUtil';\nimport { MusicNotes, Note } from './Note';\n\nexport class AudioParser {\n  // TODO state machine 1 character at a time\n  static parse(song: string): Note[] {\n    const ret: Note[] = [];\n\n    let buffer = '';\n    let state = 0; //0 F, 1 D, 2 V, 3? Slide?, 4 push\n    let n = 0;\n    let d = 0;\n    let v = 0;\n    let duty = 0;\n    for (let i = 0; i < song.length; i++) {\n      buffer += song[i];\n\n      if (state == 3) {\n        if (buffer != '.' && buffer != '$') {\n          state = 4;\n        }\n      }\n\n      if (state == 4) {\n        const frequency = MusicNotes[Object.keys(MusicNotes)[n]];\n        ret.push(new Note(frequency, d, v, duty == 3 || duty == 2, duty == 3 || duty == 1));\n        n = 0;\n        d = 0;\n        v = 0;\n        duty = 0;\n        state = 0;\n      }\n\n      if (state == 0) {\n        if (buffer.length == 2) {\n          n = TextUtil.b64PairInt(buffer);\n          buffer = '';\n          state = 1;\n        }\n      } else if (state == 1) {\n        if (buffer.length == 2) {\n          d = TextUtil.b64PairInt(buffer);\n          buffer = '';\n          state = n == 0 ? 3 : 2; // Rest skips volume\n        }\n      } else if (state == 2) {\n        const value = TextUtil.BASE64.indexOf(buffer);\n        duty = value >> 4;\n        const fourBitNum = value & 15;\n        v = fourBitNum / 15;\n        buffer = '';\n        state = 3;\n      } else if (state == 3) {\n        buffer = '';\n        state = 4;\n      }\n    }\n\n    // Push leftovers\n    if (d > 0) {\n      const frequency = MusicNotes[Object.keys(MusicNotes)[n]];\n      ret.push(new Note(frequency, d, v, duty == 3 || duty == 2, duty == 3 || duty == 1));\n    }\n\n    // console.log(ret);\n    // const frames = ret.reduce((a, b) => a + b.duration, 0);\n    // console.log(\"Total frames: \" + frames);\n    // console.log(\"Total ms: \" + frames * 16.6667);\n    return ret;\n  }\n\n  static encode(notes: Note[]): string {\n    let s = '';\n    notes.forEach((n) => {\n      s += TextUtil.intToB64Pair(Object.values(MusicNotes).indexOf(n.frequency)); // Frequency encoding\n      s += TextUtil.intToB64Pair(n.duration); // Duration encoding\n      // Encode the slide values together\n      const d =\n        n.slideFrequency && n.slideGain\n          ? 3\n          : n.slideFrequency && !n.slideGain\n          ? 2\n          : !n.slideFrequency && n.slideGain\n          ? 1\n          : 0;\n      const g = (d << 4) | Math.floor(n.gain * 15);\n      s += TextUtil.BASE64[g]; // Gain/slide encoding\n    });\n    return s;\n  }\n}\n","export class Point {\n  constructor(\n    public x: number = 0,\n    public y: number = 0,\n  ) {}\n\n  vectorMagnitude(): number {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n\n  vectorNormalize(): Point {\n    const magnitude = this.vectorMagnitude();\n    const epsilon = 1e-14;\n\n    if (magnitude < epsilon) {\n      return new Point(0, 0);\n    }\n\n    return new Point(this.x / magnitude, this.y / magnitude);\n  }\n\n  static subtractPoints(a: Point, b: Point): Point {\n    return new Point(a.x - b.x, a.y - b.y);\n  }\n\n  static getPointAtDistanceAndAngle(x: number, y: number, r: number, angle: number): Point {\n    // Convert angle from degrees to radians\n    const angleInRadians = (angle * Math.PI) / 180;\n\n    // Calculate the new X and Y coordinates\n    const newX = x + r * Math.cos(angleInRadians);\n    const newY = y + r * Math.sin(angleInRadians);\n\n    // Return the new point\n    return new Point(newX, newY);\n  }\n}\n\nexport class Point3 {\n  constructor(\n    public x: number = 0,\n    public y: number = 0,\n    public z: number = 0,\n  ) {}\n}\n","import { INPUT } from '../../game/Input';\nimport { Lifecycle } from '../../game/Lifecycle';\nimport { CanvasRenderer } from '../../graphics/CanvasRenderer';\nimport { RenderContext } from '../Render';\n\nexport class GraphicSelectionCarousel extends Lifecycle {\n  public cursorIndex = 0;\n  public maxItems = 0;\n\n  constructor(public onRender: (r: CanvasRenderer, index: number, context: RenderContext) => void) {\n    super();\n  }\n\n  update = () => {\n    // TODO max items!\n\n    if (INPUT.getKeyDown('left')) {\n      this.cursorIndex -= 1;\n      if (this.cursorIndex < 0) {\n        this.cursorIndex = this.maxItems - 1;\n      }\n    } else if (INPUT.getKeyDown('right')) {\n      this.cursorIndex += 1;\n      if (this.cursorIndex >= this.maxItems) {\n        this.cursorIndex = 0;\n      }\n    }\n  };\n}\n","import { DefaultAssets } from '../assets/DefaultAssets';\nimport { Lifecycle } from '../game/Lifecycle';\nimport { CanvasRenderer } from '../graphics/CanvasRenderer';\nimport { monoColorFilter } from '../graphics/ColorFilter';\nimport { Font } from '../text/Font';\nimport { Alignment } from './Alignment';\nimport { NextCursor } from './components/Cursor';\nimport { RenderContext } from './Render';\n\nexport class ListItem {\n  constructor(\n    public label: string,\n    public alignment: Alignment = Alignment.LEFT,\n    public colorString: string = 'A',\n    public selectable = true,\n  ) {}\n}\n\nexport class List {\n  constructor(public labels: ListItem[]) {}\n\n  public draw(\n    r: CanvasRenderer,\n    context: RenderContext,\n    font: Font,\n    kerning: number,\n    lineSpacing: number,\n  ) {\n    let y = context.startY;\n    for (let i = 0; i < this.labels.length; i++) {\n      const item = this.labels[i];\n      const m = font.measure(item.label, kerning);\n      switch (item.alignment) {\n        case Alignment.LEFT:\n          r.drawStaticText(item.label, context.startX, y, font, kerning);\n          break;\n        case Alignment.CENTER:\n          r.drawStaticText(\n            item.label,\n            context.startX + context.maxWidth / 2 - m.width / 2,\n            y,\n            font,\n            kerning,\n          );\n          break;\n        case Alignment.RIGHT:\n          r.drawStaticText(\n            item.label,\n            context.startX + context.maxWidth - m.width,\n            y,\n            font,\n            kerning,\n          );\n          break;\n      }\n      y += lineSpacing;\n    }\n  }\n}\n\nexport class ScrollableList extends Lifecycle {\n  public topOffset = 0;\n  private ncursor = new NextCursor();\n\n  constructor(\n    public labels: ListItem[],\n    public maxRowCount: number,\n  ) {\n    super();\n  }\n\n  update = () => {\n    this.ncursor.update();\n  };\n\n  public drawList(\n    r: CanvasRenderer,\n    context: RenderContext,\n    font: Font,\n    kerning: number,\n    lineSpacing: number,\n    indicatorAlignment: Alignment,\n  ) {\n    const iterationCount =\n      this.maxRowCount - (this.topOffset + this.maxRowCount < this.labels.length ? 1 : 0);\n    const startIndex = this.topOffset > 0 ? 1 : 0;\n    let y = context.startY + startIndex * lineSpacing;\n    for (let i = startIndex; i < iterationCount; i++) {\n      const trueIndex = i + this.topOffset;\n      if (trueIndex >= this.labels.length) continue;\n      const item = this.labels[trueIndex];\n      const m = font.measure(item.label, kerning);\n      switch (item.alignment) {\n        case Alignment.LEFT:\n          r.drawStaticText(\n            item.label,\n            context.startX,\n            y,\n            font,\n            kerning,\n            monoColorFilter(r.properties.defaultColorFilter.get(item.colorString)),\n          );\n          break;\n        case Alignment.CENTER:\n          r.drawStaticText(\n            item.label,\n            context.startX + context.maxWidth / 2 - m.width / 2,\n            y,\n            font,\n            kerning,\n            monoColorFilter(r.properties.defaultColorFilter.get(item.colorString)),\n          );\n          break;\n        case Alignment.RIGHT:\n          r.drawStaticText(\n            item.label,\n            context.startX + context.maxWidth - m.width,\n            y,\n            font,\n            kerning,\n            monoColorFilter(r.properties.defaultColorFilter.get(item.colorString)),\n          );\n          break;\n      }\n      y += lineSpacing;\n    }\n\n    const cursorB = DefaultAssets.ncursor_1;\n    if (this.topOffset + this.maxRowCount < this.labels.length) {\n      switch (indicatorAlignment) {\n        case Alignment.LEFT:\n          r.drawStaticBitmap(\n            context.startX,\n            context.startY + context.maxHeight - cursorB.height,\n            cursorB,\n          );\n          break;\n        case Alignment.CENTER:\n          r.drawStaticBitmap(\n            context.startX + context.maxWidth / 2 - cursorB.width / 2,\n            context.startY + context.maxHeight - cursorB.height,\n            cursorB,\n          );\n          break;\n        case Alignment.RIGHT:\n          r.drawStaticBitmap(\n            context.startX + context.maxWidth - cursorB.width,\n            context.startY + context.maxHeight - cursorB.height,\n            cursorB,\n          );\n          break;\n      }\n    }\n    const cursorBFlipped = cursorB.flipVertically();\n    if (this.topOffset > 0) {\n      switch (indicatorAlignment) {\n        case Alignment.LEFT:\n          r.drawStaticBitmap(context.startX, context.startY, cursorBFlipped);\n          break;\n        case Alignment.CENTER:\n          r.drawStaticBitmap(\n            context.startX + context.maxWidth / 2 - cursorB.width / 2,\n            context.startY,\n            cursorBFlipped,\n          );\n          break;\n        case Alignment.RIGHT:\n          r.drawStaticBitmap(\n            context.startX + context.maxWidth - cursorB.width,\n            context.startY,\n            cursorBFlipped,\n          );\n          break;\n      }\n    }\n  }\n}\n","import { CanvasRenderer } from '../graphics/CanvasRenderer';\nimport { Point3 } from '../physics/Point';\nimport { GameDriver } from './GameDriver';\nimport { GameObject } from './GameObject';\nimport { Scene } from './Scene';\n\nexport abstract class Game {\n  objects: GameObject[] = [];\n  private pendingAdds: GameObject[] = [];\n  private pendingDels: GameObject[] = [];\n  protected currentScene: Scene | null;\n\n  constructor(scene: Scene | null) {\n    this.currentScene = scene;\n  }\n\n  onUpdate() {\n    this.objects.push(...this.pendingAdds);\n    const adds = [...this.pendingAdds];\n    this.pendingAdds.length = 0;\n    adds.forEach((item) => {\n      item.start();\n      item.getComponents().forEach((component) => component?._startIfNeeded());\n    });\n\n    // Fixed Update\n    this.objects.forEach((item) => {\n      item.fixedUpdate?.();\n      item.getComponents().forEach((component) => component?.fixedUpdate());\n    });\n\n    // Physics Update\n    this.objects.forEach((item) => {\n      if (item.vx != 0 || item.vy != 0) {\n        item.move(item.x + item.vx, item.y + item.vy);\n        item.vx *= item.linearDampingX;\n        item.vy *= item.linearDampingY;\n        if (Math.abs(item.vx) < 0.05) item.vx = 0;\n        if (Math.abs(item.vy) < 0.05) item.vy = 0;\n      }\n    });\n\n    // Update\n    this.update();\n    this.objects.forEach((item) => {\n      item.update?.();\n      item.getComponents().forEach((component) => {\n        component._startIfNeeded();\n        component?.update();\n      });\n    });\n\n    // Late Update\n    this.objects.forEach((item) => {\n      item.lateUpdate?.();\n      item.getComponents().forEach((component) => component?.lateUpdate());\n    });\n\n    this.objects = this.objects.filter((item) => !this.pendingDels.includes(item));\n    const dels = [...this.pendingDels];\n    this.pendingDels.length = 0;\n    dels.forEach((item) => {\n      item.destroy();\n      item._markDestroyed();\n      item.getComponents().forEach((component) => component?.destroy());\n    });\n  }\n\n  onDraw(renderer: CanvasRenderer) {\n    this.draw(renderer);\n    // Sort objects\n    this.objects.sort((a, b) => {\n      const az = a.z,\n        bz = b.z;\n      if (az !== bz) return az - bz;\n\n      const ao = a.orderInLayer,\n        bo = b.orderInLayer;\n      return ao - bo;\n    });\n    this.objects.forEach((item) => {\n      item.draw(renderer);\n      item.getComponents().forEach((component) => component?.draw(renderer));\n      if (item.DEBUG) {\n        renderer.strokeRectangle(\n          item.x - item.colliderOffsetX,\n          item.y - item.colliderOffsetY,\n          item.width,\n          item.height,\n          item.DEBUG_COLOR,\n          1,\n        );\n      }\n    });\n    this.drawUi(renderer);\n    this.objects.forEach((item) => {\n      item.drawUi(renderer);\n      item.getComponents().forEach((component) => component?.drawUi(renderer));\n    });\n  }\n\n  public addObject(g: GameObject): void {\n    this.pendingAdds.push(g);\n  }\n\n  public changeScene(scene: Scene): void {\n    this.wipe();\n    this.currentScene = scene;\n    this.currentScene.start();\n  }\n\n  /**\n   * Wipe all pending objects. Use with care!\n   *\n   * This should only be used to reset the game.\n   */\n  public wipe(): void {\n    this.pendingAdds.length = 0;\n    this.pendingDels.length = 0;\n    this.objects.length = 0;\n  }\n\n  public destroyObject(g: GameObject): void {\n    this.pendingDels.push(g);\n  }\n\n  public findObjectByName(name: string): GameObject | null {\n    for (const item of [...this.objects, ...this.pendingAdds]) {\n      if (item.name == name) {\n        return item;\n      }\n    }\n    return null;\n  }\n\n  public findObjectById(id: number): GameObject | null {\n    for (const item of [...this.objects, ...this.pendingAdds]) {\n      if (item.instanceId() == id) {\n        return item;\n      }\n    }\n    return null;\n  }\n\n  public getFilteredObjects(filter: (go: GameObject) => boolean): GameObject[] {\n    return this.objects.filter((item) => filter(item));\n  }\n\n  public onStart() {\n    this.start();\n  }\n\n  abstract start(): void;\n  abstract update(): void;\n  abstract lateUpdate(): void;\n  abstract draw(renderer: CanvasRenderer): void;\n  abstract drawUi(renderer: CanvasRenderer): void;\n}\n\nexport const GAME = {\n  current: null as unknown as Game,\n};\n\nexport const GAMEDRIVER = {\n  current: null as unknown as GameDriver,\n};\n\nexport function instantiate(object: GameObject, location?: Point3): GameObject {\n  if (location) {\n    object.x = location.x;\n    object.y = location.y;\n    object.z = location.z;\n  }\n  GAME.current.addObject(object);\n  return object;\n}\n\nexport function destroy(object: GameObject): GameObject {\n  GAME.current.destroyObject(object);\n  return object;\n}\n","import { Bitmap } from '../graphics/Bitmap';\n\ntype BitmapDictionary = {\n  [key: string]: Bitmap;\n};\n\ntype Size = {\n  width: number;\n  height: number;\n};\n\nexport class Font {\n  constructor(\n    private charMap: BitmapDictionary,\n    private fallback: Bitmap,\n  ) {}\n\n  public get(c: string): Bitmap {\n    return this.charMap[c] ?? this.fallback;\n  }\n\n  public measure(text: string, kerning = 0): Size {\n    let w = 0;\n    let h = 0;\n\n    for (const c of text) {\n      const b = this.get(c);\n      w += b.width + kerning;\n      h = Math.max(h, b.height);\n    }\n\n    return {\n      width: w,\n      height: h,\n    };\n  }\n\n  public measureWrapped(text: string, maxWidth: number, kerning = 0, lineSpacing = 0): Size {\n    // Split the text into segments at spaces, commas, and periods\n    const segments = text.split(/([ ,.])/);\n    let currentLine = '';\n    let totalHeight = 0;\n    let maxLineWidth = 0;\n    let segmentIndex = 0;\n    let lineCount = 0;\n\n    while (segmentIndex < segments.length) {\n      const nextSegment = segments[segmentIndex];\n      const nextLine = currentLine + nextSegment;\n\n      // Measure the width of the next line of text\n      const nextLineWidth = this.measure(nextLine, kerning).width;\n\n      // If the next line fits within maxWidth, add the segment to the current line\n      if (nextLineWidth <= maxWidth) {\n        currentLine = nextLine;\n        segmentIndex++;\n      } else if (currentLine === '') {\n        // Handle the case where the first word is wider than maxWidth\n        // Add the height of the first segment to the total height\n        totalHeight += this.measure(nextSegment, kerning).height;\n        lineCount++;\n        segmentIndex++;\n        maxLineWidth = Math.max(maxLineWidth, this.measure(nextSegment, kerning).width);\n      } else {\n        // Otherwise, add the height of the current line to the total height and start a new line\n        totalHeight += this.measure(currentLine.trim(), kerning).height;\n        lineCount++;\n        maxLineWidth = Math.max(maxLineWidth, this.measure(currentLine.trim(), kerning).width);\n        currentLine = nextSegment;\n        segmentIndex++;\n      }\n    }\n\n    // Add the height of the last line to the total height\n    if (currentLine.trim() !== '') {\n      totalHeight += this.measure(currentLine.trim(), kerning).height;\n      lineCount++;\n      maxLineWidth = Math.max(maxLineWidth, this.measure(currentLine.trim(), kerning).width);\n    }\n\n    // Subtract lineSpacing for the last line, as it's not needed\n    if (lineCount > 1) {\n      totalHeight += (lineCount - 1) * lineSpacing;\n    }\n\n    // Return the total width and height\n    return {\n      width: maxLineWidth,\n      height: totalHeight,\n    };\n  }\n}\n","import { Bitmap } from '../graphics/Bitmap';\n\nexport class TextUtil {\n  static BASE64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n  static b64PairInt(base64: string): number {\n    if (base64.length != 2) {\n      throw new Error('Input must be exactly two characters');\n    }\n\n    const firstIndex = TextUtil.BASE64.indexOf(base64[0]);\n    const secondIndex = TextUtil.BASE64.indexOf(base64[1]);\n\n    if (firstIndex === -1 || secondIndex === -1) {\n      throw new Error('Input must be valid base64 characters');\n    }\n\n    return firstIndex * 64 + secondIndex;\n  }\n\n  static intToB64Pair(num: number): string {\n    if (num < 0 || num >= 64 * 64) {\n      throw new Error('Input must be a number between 0 and 4095 (inclusive)');\n    }\n\n    const firstIndex = Math.floor(num / 64);\n    const secondIndex = num % 64;\n\n    return TextUtil.BASE64[firstIndex] + TextUtil.BASE64[secondIndex];\n  }\n\n  static rleimg(w: number, h: number, rle: string): Bitmap {\n    let data = '';\n    let count = '';\n    for (const char of rle) {\n      if (char >= '0' && char <= '9') {\n        count += char;\n      } else {\n        for (let i = 0; i < parseInt(count, 10); i++) {\n          data += char;\n        }\n        count = '';\n      }\n    }\n    return new Bitmap(w, h, data);\n  }\n\n  static rle64img(rle: string): Bitmap {\n    const w = TextUtil.BASE64.indexOf(rle[0]);\n    const h = TextUtil.BASE64.indexOf(rle[1]);\n    rle = rle.slice(2);\n    let data = '';\n    let count = '';\n    for (const char of rle) {\n      if (count == '') {\n        count = char;\n      } else {\n        const n = TextUtil.BASE64.indexOf(count);\n        for (let i = 0; i < n; i++) {\n          data += char;\n        }\n        count = '';\n      }\n    }\n    // if (w * h != data.length) throw \"UNEXPECTED SIZE!\"\n    return new Bitmap(w, h, data);\n  }\n\n  // TODO if run is 64+ abort it, update bitmap.html with that change\n  static stringToRle(w: number, h: number, bitmap: string, base = 64): string {\n    let rle = '';\n    let count = 0;\n    let curC = '';\n    for (let i = 0; i < bitmap.length; i++) {\n      const c = bitmap[i];\n      // if ((c >= 'A' && c <= 'K') || c == '_') {\n      if (TextUtil.BASE64.includes(c) || c == '_') {\n        if (curC == '') {\n          curC = c;\n          count = 1;\n        } else if (curC == c) {\n          count += 1;\n          if (count == 63 && base == 64) {\n            const n = TextUtil.BASE64[count];\n            rle += n + curC;\n            count = 0;\n          }\n        } else if (curC != c) {\n          const n = base == 64 ? TextUtil.BASE64[count] : count.toString(base);\n          rle += n + curC;\n          curC = c;\n          count = 1;\n        }\n      }\n    }\n    const n = base == 64 ? TextUtil.BASE64[count] : count.toString(base);\n    rle += n + curC;\n    return TextUtil.BASE64[w] + TextUtil.BASE64[h] + rle;\n  }\n\n  static letterMapData(s: string, map: { [key: string]: string }) {\n    let result = '';\n\n    for (const char of s) {\n      if (map[char]) {\n        result += map[char];\n      } else {\n        result += char;\n      }\n    }\n\n    return result;\n  }\n\n  static chunkString(s: string, w: number): string[][] {\n    const result: string[][] = Array.from({ length: w }, () => []);\n\n    for (let i = 0; i < s.length; i++) {\n      const col = Math.floor(i / w);\n      const row = i % w;\n\n      if (!result[row]) {\n        result[row] = [];\n      }\n\n      result[row][col] = s[i];\n    }\n\n    return result;\n  }\n}\n\n// function getBrightness(r: number, g: number, b: number): number {\n//   // You can tweak the formula as needed; this is a standard approximation:\n//   return 0.299 * r + 0.587 * g + 0.114 * b;\n// }\n","import { AudioParser } from './AudioParser';\nimport {\n  Instrument,\n  NoiseInstrument,\n  PulseInstrument,\n  SquareInstrument,\n  TriangleInstrument,\n} from './Instrument';\n\n/**\n * I need an AudioMixer and AudioPlayer\n * Mixer will orchestrate the clips/songs that are playing\n * AudioPlayer will be an instance of a player that the mixer manages, with independent volume etc\n */\n\n// Make audio player options for AudioPlayer\n\n// interface AudioMixer {\n//   playSoundClip(data: string, instrumentType: InstrumentType);\n// }\n\n// interface AudioPlayer {\n//   setOnDoneListener\n//   update\n//   stop\n//}\n\nexport enum InstrumentType {\n  SQUARE,\n  TRIANGLE,\n  PULSE_D0,\n  PULSE_D1,\n  PULSE_D2,\n  PULSE_D3,\n  NOISE_LOW,\n  NOISE_HIGH,\n}\n\nexport interface AudioTrackDefinition {\n  data: string;\n  instrumentType: InstrumentType;\n  doesRepeat: boolean;\n  onDoneListener?: () => void;\n  volume?: number;\n}\n\nexport interface AudioMixer {\n  getVolume(): number;\n  setVolume(volume: number): void;\n  playSoundClip(params: AudioTrackDefinition): AudioPlayer;\n  update(): void;\n  stopAll(): void;\n}\n\nexport interface AudioPlayer {\n  getVolume(): number;\n  setVolume(volume: number): void;\n  getDoesRepeat(): boolean;\n  setDoesRepeat(doesRepeat: boolean): void;\n  setOnDoneListener(listener: () => void): void;\n  update(): void;\n  stop(): void;\n  getCurrentTime(): number;\n  getSongLength(): number;\n  getSongRemainingFrames(): number;\n  setInstrumentAsDone(instrument: Instrument): void;\n  getIsDonePlaying(): boolean;\n\n  _createPeriodicWave(\n    real: Iterable<number>,\n    imag: Iterable<number>,\n    constraints?: PeriodicWaveConstraints,\n  ): PeriodicWave;\n}\n\nclass AudioPlayerImpl implements AudioPlayer {\n  private audioContext: AudioContext;\n  private hasInitializedOscillators = false;\n\n  private volume = 0.5;\n  private doesRepeat = false;\n  private onDoneListener: () => void = () => {};\n\n  private currentTrack = '';\n  private instruments: Instrument[] = [];\n  private isStillPlayingChannel: boolean[] = [];\n  public songLength = 0;\n  public remainingFrames = 0;\n\n  constructor(params: AudioTrackDefinition) {\n    this.audioContext = AudioMixerImpl.audioContext;\n    this.doesRepeat = params.doesRepeat;\n    if (params.onDoneListener) {\n      this.onDoneListener = params.onDoneListener;\n    }\n    this.volume = params.volume ?? 0.5;\n\n    let instrument: Instrument | undefined = undefined;\n    if (params.instrumentType == InstrumentType.SQUARE) {\n      instrument = new SquareInstrument();\n    } else if (params.instrumentType == InstrumentType.TRIANGLE) {\n      instrument = new TriangleInstrument();\n    } else if (params.instrumentType == InstrumentType.PULSE_D0) {\n      const inst = new PulseInstrument(); // TODO Duty\n      instrument = inst;\n    } else if (params.instrumentType == InstrumentType.NOISE_LOW) {\n      const inst = new NoiseInstrument(); // TODO Duty\n      instrument = inst;\n    }\n\n    if (instrument) {\n      this.instruments.push(instrument);\n    }\n    this.isStillPlayingChannel = this.instruments.map(() => false);\n    this.test(params.data);\n  }\n\n  setInstrumentAsDone(instrument: Instrument): void {\n    const i = this.instruments.indexOf(instrument);\n    if (i >= 0) {\n      this.isStillPlayingChannel[i] = false;\n    }\n    if (this.getIsDonePlaying()) {\n      this.instruments.forEach((i) => i.powerOff());\n    }\n  }\n\n  getSongLength(): number {\n    return this.songLength;\n  }\n\n  getSongRemainingFrames(): number {\n    return this.remainingFrames;\n  }\n\n  getCurrentTime(): number {\n    return this.audioContext.currentTime;\n  }\n\n  getDoesRepeat(): boolean {\n    return this.doesRepeat;\n  }\n\n  setDoesRepeat(doesRepeat: boolean): void {\n    this.doesRepeat = doesRepeat;\n  }\n\n  getVolume(): number {\n    return this.volume;\n  }\n\n  setVolume(volume: number): void {\n    this.volume = volume;\n  }\n\n  update() {\n    if (this.getIsDonePlaying()) {\n      this.onDoneListener();\n      if (this.doesRepeat) {\n        // this.test(this.currentTrack);\n        this.instruments.forEach((i) => i.reset());\n        this.isStillPlayingChannel = this.instruments.map(() => true);\n        this.remainingFrames = this.songLength;\n      } else {\n        this.instruments.forEach((i) => i.powerOff());\n      }\n      return;\n    }\n    this.audioContext.resume();\n    this.instruments.forEach((i) => i.update());\n    this.remainingFrames -= 1;\n  }\n\n  setOnDoneListener(listener: () => void): void {\n    this.onDoneListener = listener;\n  }\n\n  stop() {\n    this.instruments.forEach((i) => this.setInstrumentAsDone(i));\n  }\n\n  _createPeriodicWave(real: Iterable<number>, imag: Iterable<number>): PeriodicWave {\n    return this.audioContext.createPeriodicWave(real, imag);\n  }\n\n  getIsDonePlaying(): boolean {\n    return this.isStillPlayingChannel.every((i) => !i);\n  }\n\n  public test(song: string) {\n    this.currentTrack = song;\n    this.isStillPlayingChannel = this.instruments.map(() => false);\n    this.instruments.forEach((i) => i.setTrack([]));\n\n    const tracks = song.split(':');\n    for (let i = 0; i < tracks.length; i++) {\n      if (tracks[i] == '') continue;\n      this.isStillPlayingChannel[i] = true;\n      const notes = AudioParser.parse(tracks[i]);\n      this.songLength = Math.max(\n        this.songLength,\n        notes.reduce((sum, note) => sum + note.duration, 0),\n      );\n      this.instruments[i].setTrack(notes);\n    }\n\n    this.remainingFrames = this.songLength;\n    if (this.audioContext === undefined || this.audioContext.state === 'suspended') {\n      if (this.audioContext === undefined) {\n        this.instruments.forEach((i) => i.destroy());\n        this.audioContext = new window.AudioContext();\n      }\n      this.audioContext\n        .resume()\n        .then(() => {\n          if (this.instruments[0].isDestroyed()) {\n            this.initializeOscillators();\n          }\n          this.play();\n        })\n        .catch((error) => {\n          console.error('Could not resume AudioContext', error);\n        });\n    } else {\n      if (!this.hasInitializedOscillators) {\n        this.initializeOscillators();\n      }\n      this.play();\n    }\n  }\n\n  private initializeOscillators() {\n    this.instruments.forEach((i) => i.initialize(this.audioContext, this));\n  }\n\n  private play() {\n    // TODO only start when needed, and stop when not needed\n    this.instruments.forEach((i) => i.start());\n  }\n}\n\nclass AudioMixerImpl implements AudioMixer {\n  static audioContext: AudioContext;\n  private audioPlayers: AudioPlayer[] = [];\n  private volume = 0.5;\n\n  constructor() {\n    AudioMixerImpl.audioContext = new window.AudioContext();\n  }\n\n  playSoundClip(params: AudioTrackDefinition): AudioPlayer {\n    const newPlayer = new AudioPlayerImpl(params);\n    newPlayer.setVolume(this.volume);\n    this.audioPlayers.push(newPlayer);\n    return newPlayer;\n  }\n\n  update(): void {\n    this.audioPlayers.forEach((player) => {\n      player.update();\n    });\n    this.audioPlayers = this.audioPlayers.filter((player) => {\n      // Hacky but ensure one last update for culled players\n      if (player.getIsDonePlaying() && !player.getDoesRepeat()) {\n        player.update();\n      }\n      return player.getDoesRepeat() || !player.getIsDonePlaying();\n    });\n  }\n\n  stopAll(): void {\n    this.audioPlayers.forEach((player) => {\n      player.stop();\n    });\n  }\n\n  getVolume(): number {\n    return this.volume;\n  }\n\n  setVolume(volume: number): void {\n    this.volume = volume;\n  }\n}\n\nexport const AUDIO = new AudioPlayerImpl({\n  data: '',\n  doesRepeat: false,\n  instrumentType: InstrumentType.SQUARE,\n});\nexport const A_MIXER = new AudioMixerImpl();\n\n// [note as number][duration number] |\n// : break, - slide\n\n// const bpm = 100;\n// const quarter = 'Ak'; // 36 //60000 / bpm;\n// const eigth = 'AS';\n// const half = 'BI';\n// // R 0\n// const R = 'AA';\n// // C3 37\n// const C3 = 'Al';\n// // D3 39\n// const D3 = 'An';\n// // E3 41\n// const E3 = 'Ap';\n\n// const V = 'a';\n// const V2 = '+';\n// const V3 = 'E';\n\n// const testSong = E3 + quarter + V + \".\"\n//     + D3 + quarter + V + \".\"\n//     + C3 + quarter + V2 + \".\"\n//     + R + quarter\n//     + E3 + quarter + V + \".\"\n//     + D3 + quarter + V + \".\"\n//     + C3 + quarter + V3 + \".\"\n//     + R + quarter\n//     + C3 + eigth + V\n//     + C3 + eigth + V\n//     + C3 + eigth + V2\n//     + C3 + eigth + V2\n//     + D3 + eigth + V\n//     + D3 + eigth + V\n//     + D3 + eigth + V3\n//     + D3 + eigth + V3\n//     + E3 + quarter + V\n//     + D3 + quarter + V\n//     + C3 + quarter + V2\n//     + R + quarter;\n\n// console.log(testSong);\n\n// TODO\n// Slide isn't hitting targets\n// Triangle is popping\n// Highlight playing note\n// Collapse note section toggle\n// Clamp octaves\n// Edit note button populate current note\n","import { Lifecycle } from '../../game/Lifecycle';\nimport { Bitmap } from '../../graphics/Bitmap';\nimport { CanvasRenderer } from '../../graphics/CanvasRenderer';\nimport { Font } from '../../text/Font';\nimport { ListItem } from '../DialogList';\nimport { AlertDialog } from './AlertDialog';\nimport { SelectionDialog } from './SelectionDialog';\n\nexport class AlertChoiceDialog extends Lifecycle {\n  private alertDialog: AlertDialog;\n  private selectionDialog: SelectionDialog;\n\n  constructor(\n    public onSelect: (index: number) => void,\n    public onDismiss: () => void,\n    alertDialog: AlertDialog,\n    topLeftCorner: Bitmap,\n    verticalSidePiece: Bitmap,\n    public labels: ListItem[],\n    public font: Font,\n    public kerning: number,\n    public lineSpacing: number,\n  ) {\n    super();\n    this.alertDialog = alertDialog;\n\n    const textSizes = labels.map((label) => font.measure(label.label, kerning));\n    const textHeight = textSizes\n      .map((size) => size.height)\n      .reduce((a, b) => a + b + lineSpacing, 0);\n    const maxTextWidth = Math.max(...textSizes.map((size) => size.width));\n\n    let width = maxTextWidth + verticalSidePiece.width * 2 + 9;\n    width = Math.ceil(width / topLeftCorner.width) * topLeftCorner.width;\n    let height = textHeight + topLeftCorner.height * 2;\n    height = Math.ceil(height / verticalSidePiece.height) * verticalSidePiece.height;\n\n    const x = alertDialog.getX() + alertDialog.getWidth() - width;\n    const y = alertDialog.getY() - height + verticalSidePiece.height;\n    const lineHeight = font.measure('A').height + lineSpacing;\n\n    this.selectionDialog = new SelectionDialog(\n      onSelect,\n      onDismiss,\n      x,\n      y,\n      width,\n      height,\n      topLeftCorner,\n      verticalSidePiece,\n      labels,\n      font,\n      kerning,\n      lineHeight,\n    );\n  }\n\n  update = () => {\n    this.selectionDialog.update();\n  };\n\n  drawUi = (r: CanvasRenderer) => {\n    this.alertDialog.drawUi(r);\n    this.selectionDialog.drawUi(r);\n  };\n}\n","import { Assets } from '../assets/Assets';\nimport { Bitmap } from './Bitmap';\n\nexport class AnimationSequence {\n  private sprites: Bitmap[];\n  private internalTimer = 0;\n  private currentIndex = 0;\n\n  constructor(\n    sprites: Bitmap[],\n    public frameTime: number = 0,\n    public onLoop: (() => void) | null = null,\n  ) {\n    this.sprites = sprites;\n  }\n\n  public update(): void {\n    this.internalTimer += 1;\n    if (this.internalTimer >= this.frameTime) {\n      this.internalTimer = 0;\n      this.currentIndex += 1;\n      if (this.currentIndex >= this.sprites.length) {\n        this.currentIndex = 0;\n        this.onLoop?.();\n      }\n    }\n  }\n\n  public getCurrentFrame(): number {\n    return this.currentIndex;\n  }\n\n  public get(): Bitmap {\n    return this.sprites[this.currentIndex];\n  }\n\n  public reset() {\n    this.internalTimer = 0;\n    this.currentIndex = 0;\n  }\n}\n\nexport class AnimationKeySequence {\n  private keys: number[];\n  private internalTimer = 0;\n  private currentIndex = 0;\n  private hasEnded = false;\n\n  constructor(\n    keys: number[],\n    public frameTime: number = 0,\n    public onLoop: (() => void) | null = null,\n    public doesRepeat: boolean = true,\n    public onEnd: (() => void) | null = null,\n  ) {\n    this.keys = keys;\n  }\n\n  public update(): void {\n    this.internalTimer += 1;\n    if (this.internalTimer >= this.frameTime) {\n      if (this.currentIndex >= this.keys.length - 1 && !this.doesRepeat) {\n        this.currentIndex = this.keys.length - 1; // Stay at the last frame\n        if (!this.hasEnded) {\n          this.hasEnded = true;\n          this.onEnd?.();\n        }\n        return; // Do not update if we are at the end and not repeating\n      }\n      this.internalTimer = 0;\n      this.currentIndex += 1;\n      if (this.currentIndex >= this.keys.length) {\n        if (this.doesRepeat) {\n          this.currentIndex = 0;\n        } else {\n          this.currentIndex = this.keys.length - 1;\n        }\n        this.onLoop?.();\n      }\n    }\n  }\n\n  public getCurrentFrame(): number {\n    return this.currentIndex;\n  }\n\n  public getInternalTimer(): number {\n    return this.internalTimer;\n  }\n\n  public get(): Bitmap {\n    return Assets.getBitmap(this.keys[this.currentIndex]);\n  }\n\n  public reset() {\n    this.internalTimer = 0;\n    this.currentIndex = 0;\n    this.hasEnded = false;\n  }\n\n  public setCurrentFrame(frame: number, internalTimer: number = 0): void {\n    if (frame < 0 || frame >= this.keys.length) {\n      throw new Error('Frame index out of bounds');\n    }\n    this.hasEnded = false;\n    this.currentIndex = frame;\n    this.internalTimer = internalTimer; // Reset timer to start from the current frame\n  }\n}\n","import { Direction } from '../physics/Direction';\nimport { INPUT } from './Input';\n\nexport class EightWayJoystick {\n  public lastDirection: Direction | null = null;\n\n  getDirection(): Direction | null {\n    let moved = false;\n    let ns = '';\n    let ew = '';\n    if (INPUT.isDownKey()) {\n      ns = 's';\n      moved = true;\n    } else if (INPUT.isUpKey()) {\n      ns = 'n';\n      moved = true;\n    }\n    if (INPUT.isLeftKey()) {\n      ew = 'w';\n      moved = true;\n    } else if (INPUT.isRightKey()) {\n      ew = 'e';\n      moved = true;\n    }\n    const direction = moved ? ((ns + ew) as Direction) : null;\n    this.lastDirection = direction;\n    return direction;\n  }\n}\n\nexport class HorizontalJoystick {\n  public lastDirection: Direction = 'e';\n\n  getDirection(): Direction | null {\n    let moved = false;\n    let ew = '';\n    if (INPUT.isLeftKey()) {\n      moved = true;\n      ew = 'w';\n    } else if (INPUT.isRightKey()) {\n      moved = true;\n      ew = 'e';\n    }\n\n    const direction = moved ? (ew as Direction) : null;\n    this.lastDirection = direction ?? this.lastDirection;\n    return direction;\n  }\n}\n","export class Input {\n  private isDown = false;\n  private isUp = false;\n  private isLeft = false;\n  private isRight = false;\n\n  private isA = false;\n  private isB = false;\n  private isC = false;\n  private isD = false;\n  private isZ = false;\n  private isL = false;\n  private isR = false;\n\n  private lastIsDown = false;\n  private lastIsUp = false;\n  private lastIsLeft = false;\n  private lastIsRight = false;\n\n  private lastIsA = false;\n  private lastIsB = false;\n  private lastIsC = false;\n  private lastIsD = false;\n  private lastIsZ = false;\n  private lastIsL = false;\n  private lastIsR = false;\n\n  public update(): void {\n    this.lastIsDown = this.isDown;\n    this.lastIsUp = this.isUp;\n    this.lastIsLeft = this.isLeft;\n    this.lastIsRight = this.isRight;\n\n    this.lastIsA = this.isA;\n    this.lastIsB = this.isB;\n    this.lastIsC = this.isC;\n    this.lastIsD = this.isD;\n    this.lastIsZ = this.isZ;\n    this.lastIsL = this.isL;\n    this.lastIsR = this.isR;\n  }\n\n  public getKeyDown(key: string): boolean {\n    switch (key.toLowerCase()) {\n      case 'up':\n        return this.isUp && !this.lastIsUp;\n      case 'down':\n        return this.isDown && !this.lastIsDown;\n      case 'left':\n        return this.isLeft && !this.lastIsLeft;\n      case 'right':\n        return this.isRight && !this.lastIsRight;\n      case 'a':\n        return this.isA && !this.lastIsA;\n      case 'b':\n        return this.isB && !this.lastIsB;\n      case 'c':\n        return this.isC && !this.lastIsC;\n      case 'd':\n        return this.isD && !this.lastIsD;\n      case 'z':\n        return this.isZ && !this.lastIsZ;\n      case 'l':\n        return this.isL && !this.lastIsL;\n      case 'r':\n        return this.isR && !this.lastIsR;\n      default:\n        return false;\n    }\n  }\n\n  public getKeyUp(key: string): boolean {\n    switch (key.toLowerCase()) {\n      case 'up':\n        return !this.isUp && this.lastIsUp;\n      case 'down':\n        return !this.isDown && this.lastIsDown;\n      case 'left':\n        return !this.isLeft && this.lastIsLeft;\n      case 'right':\n        return !this.isRight && this.lastIsRight;\n      case 'a':\n        return !this.isA && this.lastIsA;\n      case 'b':\n        return !this.isB && this.lastIsB;\n      case 'c':\n        return !this.isC && this.lastIsC;\n      case 'd':\n        return !this.isD && this.lastIsD;\n      case 'z':\n        return !this.isZ && this.lastIsZ;\n      case 'l':\n        return !this.isL && this.lastIsL;\n      case 'r':\n        return !this.isR && this.lastIsR;\n      default:\n        return false;\n    }\n  }\n\n  public getKey(key: string): boolean {\n    switch (key.toLowerCase()) {\n      case 'up':\n        return this.isUp;\n      case 'down':\n        return this.isDown;\n      case 'left':\n        return this.isLeft;\n      case 'right':\n        return this.isRight;\n      case 'a':\n        return this.isA;\n      case 'b':\n        return this.isB;\n      case 'c':\n        return this.isC;\n      case 'd':\n        return this.isD;\n      case 'z':\n        return this.isZ;\n      case 'l':\n        return this.isL;\n      case 'r':\n        return this.isR;\n      default:\n        return false;\n    }\n  }\n\n  public setUp(b: boolean): void {\n    this.isUp = b;\n  }\n\n  public isUpKey(): boolean {\n    return this.isUp;\n  }\n\n  public setDown(b: boolean): void {\n    this.isDown = b;\n  }\n\n  public isDownKey(): boolean {\n    return this.isDown;\n  }\n\n  public setLeft(b: boolean): void {\n    this.isLeft = b;\n  }\n\n  public isLeftKey(): boolean {\n    return this.isLeft;\n  }\n\n  public setRight(b: boolean): void {\n    this.isRight = b;\n  }\n\n  public isRightKey(): boolean {\n    return this.isRight;\n  }\n\n  public setZ(b: boolean): void {\n    this.isZ = b;\n  }\n\n  public isZKey(): boolean {\n    return this.isZ;\n  }\n\n  public setA(b: boolean): void {\n    this.isA = b;\n  }\n\n  public isAKey(): boolean {\n    return this.isA;\n  }\n\n  public setB(b: boolean): void {\n    this.isB = b;\n  }\n\n  public isBKey(): boolean {\n    return this.isB;\n  }\n\n  public setC(b: boolean): void {\n    this.isC = b;\n  }\n\n  public isCKey(): boolean {\n    return this.isC;\n  }\n\n  public setD(b: boolean): void {\n    this.isD = b;\n  }\n\n  public isDKey(): boolean {\n    return this.isD;\n  }\n}\nexport const INPUT = new Input();\n","import { RgbColor } from './RgbColor';\n\n/**\n * ColorLightMap\n *\n * Maps a \"base palette\" color to its corresponding darker/lighter variants (same index).\n *\n * - baseColors[i] <-> darker[i] <-> lighter[i]\n * - resolve(color, delta):\n *    delta === 0  -> base color (or original if not in base)\n *    delta < 0    -> darker variant (or black if not in base)\n *    delta > 0    -> lighter variant (or white if not in base)\n *\n * Fast lookups:\n * - Builds an O(1) Map keyed by RGB24 (r<<16|g<<8|b).\n * - Also caches per-(rgb24,deltaSign) results so repeated resolves are constant-time\n *   without re-checking palette or re-instantiating common results.\n */\nexport class ColorLightMap {\n  private readonly baseByRgb24 = new Map<number, number>(); // rgb24 -> palette index\n  private readonly darker: ReadonlyArray<RgbColor>;\n  private readonly lighter: ReadonlyArray<RgbColor>;\n\n  // Cache resolved output for (rgb24, sign) where sign is -1,0,+1 encoded as 0,1,2\n  // key = (rgb24 * 3) + signIndex\n  private readonly resolveCache = new Map<number, RgbColor>();\n\n  constructor(\n    baseColors: ReadonlyArray<RgbColor>,\n    darker: ReadonlyArray<RgbColor>,\n    lighter: ReadonlyArray<RgbColor>,\n  ) {\n    if (darker.length !== baseColors.length || lighter.length !== baseColors.length) {\n      throw new Error(\n        `ColorLightMap: arrays must be same length (base=${baseColors.length}, darker=${darker.length}, lighter=${lighter.length})`,\n      );\n    }\n\n    this.darker = darker;\n    this.lighter = lighter;\n\n    // Build rgb24 -> index lookup. If duplicates exist, last one wins (deterministic).\n    for (let i = 0; i < baseColors.length; i++) {\n      const c = baseColors[i];\n      if (c.isNone()) continue; // ignore sentinel colors\n      this.baseByRgb24.set(ColorLightMap.rgb24(c), i);\n    }\n  }\n\n  // Add this cache field (instead of resolveCache keyed by sign)\n  private readonly resolveCacheByRgb24 = new Map<number, Map<number, RgbColor>>();\n\n  resolve(color: RgbColor, delta: number): RgbColor {\n    delta = Math.trunc(delta);\n    if (delta === 0) return color;\n\n    if (color.isNone()) return color;\n\n    const startRgb24 = ColorLightMap.rgb24(color);\n\n    // Cache lookup: per-color map of delta -> result\n    const bucket = this.resolveCacheByRgb24.get(startRgb24);\n    if (bucket) {\n      const cached = bucket.get(delta);\n      if (cached) return cached;\n    }\n\n    const sign = delta < 0 ? -1 : 1;\n    let steps = Math.abs(delta);\n\n    let cur: RgbColor = color;\n\n    while (steps-- > 0) {\n      const rgb24 = ColorLightMap.rgb24(cur);\n      const idx = this.baseByRgb24.get(rgb24);\n\n      if (idx === undefined) {\n        // Not a base palette color at THIS step  fallback and stop\n        cur = sign < 0 ? RgbColor.black : RgbColor.white;\n        break;\n      }\n\n      // Step once\n      cur = sign < 0 ? this.darker[idx] : this.lighter[idx];\n\n      // If we stepped into a sentinel, stop (optional but safe)\n      if (cur.isNone()) break;\n    }\n\n    // Store in cache\n    let outBucket = this.resolveCacheByRgb24.get(startRgb24);\n    if (!outBucket) {\n      outBucket = new Map<number, RgbColor>();\n      this.resolveCacheByRgb24.set(startRgb24, outBucket);\n    }\n    outBucket.set(delta, cur);\n\n    return cur;\n  }\n\n  /** Optional: clear runtime resolve cache if palette mappings stay same but you want to free memory. */\n  clearCache(): void {\n    this.resolveCache.clear();\n  }\n\n  private static rgb24(c: RgbColor): number {\n    // Clamp to byte range just in case callers pass weird values\n    const r = (c.r & 0xff) >>> 0;\n    const g = (c.g & 0xff) >>> 0;\n    const b = (c.b & 0xff) >>> 0;\n    return (r << 16) | (g << 8) | b;\n  }\n}\n","export type Direction = 's' | 'sw' | 'w' | 'nw' | 'n' | 'ne' | 'e' | 'se';\n\nexport class DirectionUtil {\n  static getAngle(d: Direction): number {\n    if (d == 'e') return 0;\n    if (d == 'se') return 45;\n    if (d == 's') return 90;\n    if (d == 'sw') return 135;\n    if (d == 'w') return 180;\n    if (d == 'nw') return 225;\n    if (d == 'n') return 270;\n    if (d == 'ne') return 315;\n    return 0;\n  }\n\n  static oppositeDirection(d: Direction): Direction {\n    if (d == 'e') return 'w';\n    if (d == 'se') return 'nw';\n    if (d == 's') return 'n';\n    if (d == 'sw') return 'ne';\n    if (d == 'w') return 'e';\n    if (d == 'nw') return 'se';\n    if (d == 'n') return 's';\n    if (d == 'ne') return 'sw';\n    return 's';\n  }\n\n  static getOrthogonalDirections(d: Direction): Direction[] {\n    if (d === 'n' || d === 's') return ['w', 'e'];\n    if (d === 'e' || d === 'w') return ['n', 's'];\n\n    if (d === 'ne' || d === 'sw') return ['nw', 'se'];\n    if (d === 'nw' || d === 'se') return ['ne', 'sw'];\n\n    return ['n', 's'];\n  }\n}\n","import { Lifecycle } from '../../game/Lifecycle';\nimport { Bitmap } from '../../graphics/Bitmap';\nimport { CanvasRenderer } from '../../graphics/CanvasRenderer';\nimport { RgbColor } from '../../graphics/RgbColor';\nimport { RenderContext } from '../Render';\n\nexport class Dialog extends Lifecycle {\n  private topLeftCorner: Bitmap;\n  private topRightCorner: Bitmap;\n  private bottomRightCorner: Bitmap;\n  private bottomLeftCorner: Bitmap;\n\n  private verticalSidePieceLeft: Bitmap;\n  private verticalSidePieceRight: Bitmap;\n  private horizontalSidePieceTop: Bitmap;\n  private horizontalSidePieceBottom: Bitmap;\n\n  constructor(\n    public x: number,\n    public y: number,\n    public width: number,\n    public height: number,\n    topLeftCorner: Bitmap,\n    verticalSidePiece: Bitmap,\n    public backgroundColor: RgbColor | null = null,\n  ) {\n    super();\n    // TODO fix hacks with horizontal for flipVertically bug\n    this.topLeftCorner = topLeftCorner;\n    this.topRightCorner = topLeftCorner.flipHorizontally();\n    this.bottomLeftCorner = topLeftCorner.flipVertically().flipHorizontally();\n    this.bottomRightCorner = this.bottomLeftCorner.flipHorizontally();\n\n    this.verticalSidePieceLeft = verticalSidePiece;\n    this.verticalSidePieceRight = verticalSidePiece.flipHorizontally();\n    this.horizontalSidePieceTop = verticalSidePiece.rotate90();\n    this.horizontalSidePieceBottom = this.horizontalSidePieceTop\n      .flipVertically()\n      .flipHorizontally();\n  }\n\n  public getFrameWidth(): number {\n    return this.verticalSidePieceLeft.width;\n  }\n\n  public getFrameHeight(): number {\n    return this.horizontalSidePieceTop.width;\n  }\n\n  public getFrameFullWidth(): number {\n    return this.verticalSidePieceLeft.width + this.verticalSidePieceRight.width;\n  }\n\n  public getFrameFullHeight(): number {\n    return this.horizontalSidePieceTop.width + this.horizontalSidePieceBottom.width;\n  }\n\n  public getRenderContext(\n    paddingLeft = 0,\n    paddingRight = 0,\n    paddingTop = 0,\n    paddingBottom = 0,\n  ): RenderContext {\n    return {\n      startX: this.x + this.getFrameWidth() + paddingLeft,\n      startY: this.y + this.getFrameHeight() + paddingTop,\n      maxWidth:\n        this.width - this.getFrameWidth() - this.getFrameWidth() - (paddingLeft + paddingRight),\n      maxHeight:\n        this.height - this.getFrameHeight() - this.getFrameHeight() - (paddingTop + paddingBottom),\n    };\n  }\n\n  drawUi = (r: CanvasRenderer) => {\n    // Background\n    r.fillStaticRectangle(\n      this.x + this.topLeftCorner.width / 2,\n      this.y + this.topLeftCorner.height / 2,\n      this.width - this.topLeftCorner.width,\n      this.height - this.topLeftCorner.height,\n      this.backgroundColor ?? r.properties.defaultColorFilter.get('D'),\n    );\n    // Horizontal\n    for (\n      let i = this.x + this.topLeftCorner.width;\n      i < this.x + this.width - this.horizontalSidePieceTop.width;\n      i += this.horizontalSidePieceTop.width\n    ) {\n      r.drawStaticBitmap(i, this.y, this.horizontalSidePieceTop);\n      r.drawStaticBitmap(\n        i,\n        this.y + this.height - this.horizontalSidePieceBottom.height,\n        this.horizontalSidePieceBottom,\n      );\n    }\n    // Vertical\n    for (\n      let i = this.y + this.topLeftCorner.height;\n      i < this.y + this.height - this.bottomLeftCorner.height;\n      i += this.topRightCorner.height\n    ) {\n      r.drawStaticBitmap(this.x, i, this.verticalSidePieceLeft);\n      r.drawStaticBitmap(\n        this.x + this.width - this.verticalSidePieceRight.width,\n        i,\n        this.verticalSidePieceRight,\n      );\n    }\n    // Corners\n    r.drawStaticBitmap(this.x, this.y, this.topLeftCorner);\n    r.drawStaticBitmap(\n      this.x + this.width - this.topRightCorner.width,\n      this.y,\n      this.topRightCorner,\n    );\n    r.drawStaticBitmap(\n      this.x,\n      this.y + this.height - this.bottomLeftCorner.height,\n      this.bottomLeftCorner,\n    );\n    r.drawStaticBitmap(\n      this.x + this.width - this.bottomRightCorner.width,\n      this.y + this.height - this.bottomLeftCorner.height,\n      this.bottomRightCorner,\n    );\n  };\n}\n","export class RgbColor {\n  static none: RgbColor = new RgbColor(-1, -1, -1);\n  static red: RgbColor = new RgbColor(255, 0, 0);\n  static darkred: RgbColor = new RgbColor(139, 0, 0);\n  static green: RgbColor = new RgbColor(0, 255, 0);\n  static darkgreen: RgbColor = new RgbColor(0, 100, 0);\n  static lightblue: RgbColor = new RgbColor(128, 128, 255);\n  static blue: RgbColor = new RgbColor(0, 0, 255);\n  static darkblue: RgbColor = new RgbColor(0, 0, 139);\n  static black: RgbColor = new RgbColor(0, 0, 0);\n  static white: RgbColor = new RgbColor(255, 255, 255);\n  static magenta: RgbColor = new RgbColor(255, 0, 255);\n  static yellow: RgbColor = new RgbColor(255, 255, 0);\n  static mc1: RgbColor = new RgbColor(15, 56, 15);\n  static mc2: RgbColor = new RgbColor(48, 98, 48);\n  static mc3: RgbColor = new RgbColor(139, 172, 15);\n  static mc4: RgbColor = new RgbColor(155, 188, 15);\n  static gs2: RgbColor = new RgbColor(84, 84, 84);\n  static gs3: RgbColor = new RgbColor(169, 169, 169);\n\n  static icecream1: RgbColor = new RgbColor(124, 63, 88);\n  static icecream2: RgbColor = new RgbColor(235, 107, 111);\n  static icecream3: RgbColor = new RgbColor(249, 168, 117);\n  static icecream4: RgbColor = new RgbColor(255, 246, 211);\n\n  static sepia1: RgbColor = new RgbColor(53, 30, 13);\n  static sepia2: RgbColor = new RgbColor(89, 64, 38);\n  static sepia3: RgbColor = new RgbColor(177, 149, 114);\n  static sepia4: RgbColor = new RgbColor(250, 224, 192);\n  static blue2: RgbColor = new RgbColor(40, 64, 248);\n  static blue3: RgbColor = new RgbColor(88, 184, 248);\n\n  static lemonlime1: RgbColor = new RgbColor(40, 55, 91);\n  static lemonlime2: RgbColor = new RgbColor(57, 128, 156);\n  static lemonlime3: RgbColor = new RgbColor(95, 204, 134);\n  static lemonlime4: RgbColor = new RgbColor(255, 243, 123);\n  static orangeblue1: RgbColor = new RgbColor(0, 48, 59);\n  static orangeblue2: RgbColor = new RgbColor(255, 119, 119);\n  static orangeblue3: RgbColor = new RgbColor(255, 206, 150);\n  static orangeblue4: RgbColor = new RgbColor(241, 242, 218);\n  static greenblue1: RgbColor = new RgbColor(51, 44, 80);\n  static greenblue2: RgbColor = new RgbColor(70, 135, 143);\n  static greenblue3: RgbColor = new RgbColor(148, 227, 68);\n  static greenblue4: RgbColor = new RgbColor(226, 243, 228);\n  static rustic1: RgbColor = new RgbColor(44, 33, 55);\n  static rustic2: RgbColor = new RgbColor(118, 68, 98);\n  static rustic3: RgbColor = new RgbColor(237, 180, 161);\n  static rustic4: RgbColor = new RgbColor(169, 104, 104);\n  static mist1: RgbColor = new RgbColor(45, 27, 0);\n  static mist2: RgbColor = new RgbColor(30, 96, 110);\n  static mist3: RgbColor = new RgbColor(90, 185, 168);\n  static mist4: RgbColor = new RgbColor(196, 240, 194);\n  static wish1: RgbColor = new RgbColor(98, 46, 76);\n  static wish2: RgbColor = new RgbColor(117, 80, 232);\n  static wish3: RgbColor = new RgbColor(96, 143, 207);\n  static wish4: RgbColor = new RgbColor(139, 229, 255);\n  static crimson1: RgbColor = new RgbColor(239, 249, 214);\n  static crimson2: RgbColor = new RgbColor(186, 80, 68);\n  static crimson3: RgbColor = new RgbColor(122, 28, 75);\n  static crimson4: RgbColor = new RgbColor(27, 3, 38);\n  static spacehaze1: RgbColor = new RgbColor(248, 227, 196);\n  static spacehaze2: RgbColor = new RgbColor(204, 52, 149);\n  static spacehaze3: RgbColor = new RgbColor(107, 31, 177);\n  static spacehaze4: RgbColor = new RgbColor(11, 6, 48);\n  static aqua1: RgbColor = new RgbColor(0, 43, 89);\n  static aqua2: RgbColor = new RgbColor(0, 95, 140);\n  static aqua3: RgbColor = new RgbColor(0, 185, 190);\n  static aqua4: RgbColor = new RgbColor(159, 244, 229);\n  static nostalgia1: RgbColor = new RgbColor(208, 208, 88);\n  static nostalgia2: RgbColor = new RgbColor(160, 168, 64);\n  static nostalgia3: RgbColor = new RgbColor(112, 128, 40);\n  static nostalgia4: RgbColor = new RgbColor(64, 80, 16);\n  static purple1: RgbColor = new RgbColor(45, 22, 44);\n  static purple2: RgbColor = new RgbColor(65, 39, 82);\n  static purple3: RgbColor = new RgbColor(104, 58, 104);\n  static purple4: RgbColor = new RgbColor(151, 117, 166);\n  static autumn1: RgbColor = new RgbColor(218, 211, 175);\n  static autumn2: RgbColor = new RgbColor(213, 136, 99);\n  static autumn3: RgbColor = new RgbColor(194, 58, 115);\n  static autumn4: RgbColor = new RgbColor(44, 30, 116);\n  static firey1: RgbColor = new RgbColor(26, 33, 41);\n  static firey2: RgbColor = new RgbColor(49, 33, 55);\n  static firey3: RgbColor = new RgbColor(81, 40, 57);\n  static firey4: RgbColor = new RgbColor(113, 49, 65);\n  static mint1: RgbColor = new RgbColor(64, 51, 47);\n  static mint2: RgbColor = new RgbColor(133, 109, 82);\n  static mint3: RgbColor = new RgbColor(149, 199, 152);\n  static mint4: RgbColor = new RgbColor(251, 255, 224);\n  static amber1: RgbColor = new RgbColor(13, 4, 5);\n  static amber2: RgbColor = new RgbColor(94, 18, 16);\n  static amber3: RgbColor = new RgbColor(211, 86, 0);\n  static amber4: RgbColor = new RgbColor(254, 208, 24);\n  static coral1: RgbColor = new RgbColor(255, 208, 164);\n  static coral2: RgbColor = new RgbColor(244, 148, 156);\n  static coral3: RgbColor = new RgbColor(124, 154, 172);\n  static coral4: RgbColor = new RgbColor(104, 81, 138);\n\n  constructor(\n    public r: number = 0,\n    public g: number = 0,\n    public b: number = 0,\n  ) {\n    this.r = Math.floor(r);\n    this.g = Math.floor(g);\n    this.b = Math.floor(b);\n  }\n\n  public equals(other: RgbColor): boolean {\n    return this.r == other.r && this.g == other.g && this.b == other.b;\n  }\n\n  public clear(): void {\n    if (this.isNone()) return;\n    this.r = 0;\n    this.g = 0;\n    this.b = 0;\n  }\n\n  public grey(v: number): void {\n    if (this.isNone()) return;\n    this.r = v;\n    this.g = v;\n    this.b = v;\n  }\n\n  public set(color: RgbColor): void {\n    if (this.isNone() || color.isNone()) return;\n    this.r = color.r;\n    this.g = color.g;\n    this.b = color.b;\n  }\n\n  public isNone(): boolean {\n    return this.r < 0 || this.g < 0 || this.b < 0;\n  }\n\n  public copy(): RgbColor {\n    return new RgbColor(this.r, this.g, this.b);\n  }\n\n  static getHexColorString(color: RgbColor): string {\n    let r = color.r.toString(16);\n    let g = color.g.toString(16);\n    let b = color.b.toString(16);\n\n    if (r.length == 1) {\n      r = '0' + r;\n    }\n    if (g.length == 1) {\n      g = '0' + g;\n    }\n    if (b.length == 1) {\n      b = '0' + b;\n    }\n\n    return '#' + r + g + b;\n  }\n}\n\nexport interface Rgb {\n  r: number;\n  g: number;\n  b: number;\n}\n","import { GameObject } from '../game/GameObject';\nimport { Point } from './Point';\nimport { Vector } from './Vector';\n\nexport class Collision {\n  static unitVectorBetweenObjects(g1: GameObject, g2: GameObject): Point {\n    return Vector.unitVector(g1.x, g1.y, g2.x, g2.y);\n  }\n\n  static distanceSquaredBetweenObjects(a: GameObject, b: GameObject): number {\n    return Vector.distanceSquared(a.x, a.y, b.x, b.y);\n  }\n\n  static checkIfRectanglesCollide(\n    x1: number,\n    y1: number,\n    w1: number,\n    h1: number,\n    x2: number,\n    y2: number,\n    w2: number,\n    h2: number,\n  ): boolean {\n    return x1 < x2 + w2 && x1 + w1 > x2 && y1 < y2 + h2 && h1 + y1 > y2;\n  }\n\n  static checkIfObjectsCollide(obj1: GameObject, obj2: GameObject): boolean {\n    return Collision.checkIfRectanglesCollide(\n      obj1.x - obj1.colliderOffsetX,\n      obj1.y - obj1.colliderOffsetY,\n      obj1.width,\n      obj1.height,\n      obj2.x - obj2.colliderOffsetX,\n      obj2.y - obj2.colliderOffsetY,\n      obj2.width,\n      obj2.height,\n    );\n  }\n}\n","import { TextUtil } from '../text/TextUtil';\nimport { ColorFilter } from './ColorFilter';\n\nexport class Bitmap {\n  constructor(\n    public width: number,\n    public height: number,\n    public data: string,\n    public filter: ColorFilter | null = null,\n  ) {}\n\n  static rect(color: string, width: number, height: number): Bitmap {\n    let data = '';\n    for (let i = 0; i < width * height; i++) {\n      data += color;\n    }\n    return new Bitmap(width, height, data);\n  }\n\n  public mask(x1: number, y1: number, x2: number, y2: number): Bitmap {\n    // Normalise and clamp bounds\n    const left = Math.max(0, Math.min(x1, x2));\n    const right = Math.min(this.width - 1, Math.max(x1, x2));\n    const top = Math.max(0, Math.min(y1, y2));\n    const bottom = Math.min(this.height - 1, Math.max(y1, y2));\n\n    /* split data into row strings */\n    const rows: string[] = [];\n    for (let i = 0; i < this.data.length; i += this.width) {\n      rows.push(this.data.slice(i, i + this.width));\n    }\n\n    /* mask each affected row */\n    for (let y = top; y <= bottom; ++y) {\n      const row = rows[y];\n      rows[y] =\n        row.slice(0, left) + // keep left part\n        '_'.repeat(right - left + 1) + // transparent pixels\n        row.slice(right + 1); // keep right part\n    }\n\n    /* stitch the rows back together */\n    let newData = '';\n    for (let i = 0; i < rows.length; ++i) {\n      newData += rows[i];\n    }\n\n    return new Bitmap(this.width, this.height, newData, this.filter);\n  }\n\n  /**\n   * Get a copy of this Bitmap flipped horizontally\n   *\n   * @returns A copy of this Bitmap flipped horizontally\n   */\n  public flipHorizontally(): Bitmap {\n    // Split the data string into an array of rows\n    const rows: string[] = [];\n\n    for (let i = 0; i < this.data.length; i += this.width) {\n      rows.push(this.data.slice(i, i + this.width));\n    }\n\n    // Reverse each row\n    const flippedRows = rows.map((row) => row.split('').reverse().join(''));\n\n    // Join the rows back together into a single string\n    const flippedData = flippedRows.join('');\n\n    return new Bitmap(this.width, this.height, flippedData, this.filter);\n  }\n\n  /**\n   * Get a copy of this Bitmap flipped vertically\n   *\n   * @returns A copy of this Bitmap flipped vertically\n   */\n  public flipVertically(): Bitmap {\n    // Split the data string into an array of rows\n    const rows: string[] = [];\n\n    for (let i = 0; i < this.data.length; i += this.height) {\n      rows.push(this.data.slice(i, i + this.height));\n    }\n\n    // reverse the order of the rows\n    rows.reverse();\n\n    // Reverse each row\n    const flippedRows = rows.map((row) => row.split('').reverse().join(''));\n\n    // Join the rows back together into a single string\n    const flippedData = flippedRows.join('');\n\n    return new Bitmap(this.width, this.height, flippedData, this.filter);\n  }\n\n  /**\n   * Returns a copy of this bitmap rotated 270 degrees\n   *\n   * @returns A bitmap that is a representation of the original bitmap flipped 270 degrees\n   */\n  public rotate90(): Bitmap {\n    // Split the data string into an array of rows\n    const rows: string[] = [];\n\n    for (let i = 0; i < this.data.length; i += this.width) {\n      rows.push(this.data.slice(i, i + this.width));\n    }\n\n    // Initialize the rotated data array\n    const rotatedData: string[][] = [];\n\n    // Create a new empty row for each column in the original bitmap\n    for (let i = 0; i < this.width; i++) {\n      rotatedData.push([]);\n    }\n\n    // Fill the rotated data array by iterating through the original rows\n    // and adding each character to the rotated data array in the correct order\n    for (let i = 0; i < this.height; i++) {\n      for (let j = 0; j < this.width; j++) {\n        rotatedData[j][this.height - 1 - i] = rows[i][j];\n      }\n    }\n\n    // Join the rotated data array into a single string\n    const rotatedDataString = rotatedData.map((row) => row.join('')).join('');\n\n    // Swap width and height for the rotated bitmap\n    const newWidth = this.height;\n    const newHeight = this.width;\n\n    return new Bitmap(newWidth, newHeight, rotatedDataString, this.filter);\n  }\n\n  /**\n   * Returns a copy of this bitmap rotated 270 degrees\n   *\n   * @returns A bitmap that is a representation of the original bitmap flipped 270 degrees\n   */\n  public rotate180(): Bitmap {\n    // Split the data string into an array of rows\n    const rows: string[] = [];\n\n    for (let i = 0; i < this.data.length; i += this.width) {\n      rows.push(this.data.slice(i, i + this.width));\n    }\n\n    // Reverse the order of the rows and reverse each row\n    const flippedRows = rows.reverse().map((row) => row.split('').reverse().join(''));\n\n    // Join the rows back together into a single string\n    const rotatedData = flippedRows.join('');\n\n    return new Bitmap(this.width, this.height, rotatedData, this.filter);\n  }\n\n  /**\n   * Returns a copy of this bitmap rotated 270 degrees\n   *\n   * @returns A bitmap that is a representation of the original bitmap flipped 270 degrees\n   */\n  public rotate270(): Bitmap {\n    // Split the data string into an array of rows\n    const rows: string[] = [];\n\n    for (let i = 0; i < this.data.length; i += this.width) {\n      rows.push(this.data.slice(i, i + this.width));\n    }\n\n    // Initialize the rotated data array\n    const rotatedData: string[][] = [];\n\n    // Create a new empty row for each column in the original bitmap\n    for (let i = 0; i < this.width; i++) {\n      rotatedData.push([]);\n    }\n\n    // Fill the rotated data array by iterating through the original rows\n    // and adding each character to the rotated data array in the correct order\n    for (let i = 0; i < this.height; i++) {\n      for (let j = 0; j < this.width; j++) {\n        rotatedData[this.width - 1 - j][i] = rows[i][j];\n      }\n    }\n\n    // Join the rotated data array into a single string\n    const rotatedDataString = rotatedData.map((row) => row.join('')).join('');\n\n    // Swap width and height for the rotated bitmap\n    const newWidth = this.height;\n    const newHeight = this.width;\n\n    return new Bitmap(newWidth, newHeight, rotatedDataString, this.filter);\n  }\n\n  public letterMap(map: { [key: string]: string }): Bitmap {\n    return new Bitmap(this.width, this.height, TextUtil.letterMapData(this.data, map), this.filter);\n  }\n\n  public setFilter(filter: ColorFilter): Bitmap {\n    this.filter = filter;\n    return this;\n  }\n}\n","import { AnimationSequence } from '../graphics/Animation';\nimport { Bitmap } from '../graphics/Bitmap';\n\nexport interface Decoration {\n  update(): void;\n  getFrame(): Bitmap;\n}\n\nexport class StaticDecoration implements Decoration {\n  private bitmap: Bitmap;\n  constructor(bitmap: Bitmap) {\n    this.bitmap = bitmap;\n  }\n  update(): void {}\n  getFrame(): Bitmap {\n    return this.bitmap;\n  }\n}\n\nexport class AnimatedDecoration implements Decoration {\n  private animation: AnimationSequence;\n\n  constructor(bitmaps: Bitmap[], frameTime: number) {\n    this.animation = new AnimationSequence(bitmaps, frameTime);\n  }\n  update(): void {\n    this.animation.update();\n  }\n  getFrame(): Bitmap {\n    return this.animation.get();\n  }\n}\n","import { TextUtil } from '../text/TextUtil';\n\nexport class DefaultAssets {\n  static ncursor_1 = TextUtil.rle64img('IHQAB_GAC_GAD_EAE_EAF_CAD_');\n  static ncursor_2 = TextUtil.rle64img('IH4_');\n  static scursor_1 = TextUtil.rle64img('HICAF_EAD_GAB_UAB_EAD_CAF_');\n  static scursor_2 = TextUtil.rle64img('HI4_');\n}\n","import { Bitmap } from './Bitmap';\nimport { ColorFilter } from './ColorFilter';\nimport { ColorLightMap } from './ColorLightMap';\nimport { GameGraphics, RgbColorArray } from './GameGraphics';\nimport { GraphicsProperties } from './GraphicsProperties';\nimport { RgbColor } from './RgbColor';\n\nexport class Pixels {\n  private pixels: RgbColorArray;\n  private width: number;\n  private height: number;\n  private dirty = true;\n  private defaultColorFilter: ColorFilter;\n\n  constructor(properties: GraphicsProperties) {\n    this.width = properties.width;\n    this.height = properties.height;\n    this.defaultColorFilter = properties.defaultColorFilter;\n    this.pixels = GameGraphics.createPixelArray(properties.width, properties.height);\n  }\n\n  public toRgbaArray(): Uint8ClampedArray {\n    const rgbaPixelArray = new Uint8ClampedArray(this.width * this.height * 4);\n    for (let i = 0, j = 0; i < this.pixels.length; i++, j += 4) {\n      const colorValue = this.pixels[i];\n      rgbaPixelArray[j] = colorValue.r; // Red\n      rgbaPixelArray[j + 1] = colorValue.g; // Green\n      rgbaPixelArray[j + 2] = colorValue.b; // Blue\n      rgbaPixelArray[j + 3] = 255; // Alpha\n    }\n    return rgbaPixelArray;\n  }\n\n  public isDirty(): boolean {\n    return this.dirty;\n  }\n\n  public setDirty(): void {\n    this.dirty = true;\n  }\n\n  public setClean(): void {\n    this.dirty = false;\n  }\n\n  public clear(): void {\n    for (let i = 0; i < this.pixels.length; i++) {\n      this.pixels[i].clear();\n    }\n  }\n\n  public fillColor(color: RgbColor): void {\n    this.dirty = true;\n    for (let i = 0; i < this.pixels.length; i++) {\n      this.pixels[i].set(color);\n    }\n  }\n\n  public drawBitmap(x: number, y: number, bitmap: Bitmap): void {\n    if (x > this.width) return;\n    if (y > this.height) return;\n    if (x + bitmap.width < 0) return;\n    if (y + bitmap.height < 0) return;\n    x = Math.round(x);\n    y = Math.round(y);\n\n    let start = y * this.width + x; // This is x,y\n    let bIndex = 0;\n    const availableWidth = this.width - x;\n    const drawWidth = Math.max(Math.min(bitmap.width, availableWidth), 0);\n    let cx = x;\n    let cy = y;\n\n    // TODO this can be optimized\n    for (let j = 0; j < bitmap.height; j++) {\n      for (let i = start; i < start + drawWidth; i++) {\n        if (cx >= 0 && cx < this.width && cy >= 0 && cy < this.height) {\n          const filter =\n            bitmap.filter ?? this.defaultColorFilter ?? ColorFilter.gameboyGreyscaleFilter;\n          this.pixels[i].set(filter.map[bitmap.data[bIndex]] ?? filter.fallbackColor);\n        }\n        cx += 1;\n        bIndex += 1;\n      }\n      cy += 1;\n      cx = x;\n      bIndex += bitmap.width - drawWidth;\n      start += this.width;\n    }\n  }\n\n  public drawLightBitmap(\n    x: number,\n    y: number,\n    intensity: number,\n    bitmap: Bitmap,\n    colorLightMap: ColorLightMap,\n  ): void {\n    if (x > this.width) return;\n    if (y > this.height) return;\n    if (x + bitmap.width < 0) return;\n    if (y + bitmap.height < 0) return;\n\n    this.dirty = true;\n\n    x = Math.round(x);\n    y = Math.round(y);\n\n    let start = y * this.width + x; // This is x,y\n    let bIndex = 0;\n    const availableWidth = this.width - x;\n    const drawWidth = Math.max(Math.min(bitmap.width, availableWidth), 0);\n    let cx = x;\n    let cy = y;\n    const filter = bitmap.filter ?? this.defaultColorFilter ?? ColorFilter.gameboyGreyscaleFilter;\n\n    for (let j = 0; j < bitmap.height; j++) {\n      for (let i = start; i < start + drawWidth; i++) {\n        if (cx >= 0 && cx < this.width && cy >= 0 && cy < this.height) {\n          // This is the exact color drawBitmap would attempt to draw\n          const maskColor = filter.map[bitmap.data[bIndex]] ?? filter.fallbackColor;\n\n          // Only apply lighting where drawBitmap would actually draw a color\n          if (!maskColor.isNone()) {\n            const dst = this.pixels[i];\n            const lit = colorLightMap.resolve(dst, intensity);\n            dst.set(lit);\n          }\n        }\n\n        cx += 1;\n        bIndex += 1;\n      }\n\n      cy += 1;\n      cx = x;\n      bIndex += bitmap.width - drawWidth;\n      start += this.width;\n    }\n  }\n\n  public setPixel(x: number, y: number, color: RgbColor): void {\n    this.dirty = true;\n    x = Math.floor(x);\n    y = Math.floor(y);\n    if (x < 0 || x >= this.width || y < 0 || y >= this.height) return;\n    this.pixels[y * this.width + x] = color.copy();\n  }\n\n  public strokeRectangle(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    color: RgbColor,\n    thickness = 1,\n    cornerRadius = 0,\n  ): void {\n    color = color.copy();\n    // Draw the top and bottom sides of the rectangle\n    this.drawLine(x + cornerRadius, y, x + width - cornerRadius, y, color, thickness);\n    this.drawLine(\n      x + cornerRadius,\n      y + height,\n      x + width - cornerRadius,\n      y + height,\n      color,\n      thickness,\n    );\n    // Draw the left and right sides of the rectangle\n    this.drawLine(x, y + cornerRadius, x, y + height - cornerRadius, color, thickness);\n    this.drawLine(\n      x + width,\n      y + cornerRadius,\n      x + width,\n      y + height - cornerRadius,\n      color,\n      thickness,\n    );\n\n    if (cornerRadius > 0) {\n      this.strokeArc(x + cornerRadius, y + cornerRadius, cornerRadius, 180, 270, color, thickness);\n      this.strokeArc(\n        x + width - cornerRadius,\n        y + cornerRadius,\n        cornerRadius,\n        270,\n        0,\n        color,\n        thickness,\n      );\n      this.strokeArc(\n        x + cornerRadius,\n        y + height - cornerRadius,\n        cornerRadius,\n        90,\n        180,\n        color,\n        thickness,\n      );\n      this.strokeArc(\n        x + width - cornerRadius,\n        y + height - cornerRadius,\n        cornerRadius,\n        0,\n        90,\n        color,\n        thickness,\n      );\n    }\n  }\n\n  public fillRectangle(x: number, y: number, width: number, height: number, color: RgbColor): void {\n    this.dirty = true;\n    color = color.copy();\n    for (let i = 0; i < width; ++i) {\n      for (let j = 0; j < height; ++j) {\n        this.setPixel(x + i, y + j, color);\n      }\n    }\n  }\n\n  public fillLightRectangle(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    intensity: number,\n    colorLightMap: ColorLightMap,\n  ): void {\n    this.dirty = true;\n\n    x = Math.floor(x);\n    y = Math.floor(y);\n    width = Math.floor(width);\n    height = Math.floor(height);\n\n    if (width <= 0 || height <= 0) return;\n    if (x > this.width || y > this.height) return;\n    if (x + width < 0 || y + height < 0) return;\n\n    // Clip to screen bounds\n    const startX = Math.max(0, x);\n    const startY = Math.max(0, y);\n    const endX = Math.min(this.width, x + width); // exclusive\n    const endY = Math.min(this.height, y + height); // exclusive\n\n    // Apply lighting in-place\n    for (let yy = startY; yy < endY; yy++) {\n      let idx = yy * this.width + startX;\n      for (let xx = startX; xx < endX; xx++, idx++) {\n        const dst = this.pixels[idx];\n        const lit = colorLightMap.resolve(dst, intensity);\n        dst.set(lit);\n      }\n    }\n  }\n\n  public strokeCircle(\n    xCenter: number,\n    yCenter: number,\n    radius: number,\n    color: RgbColor,\n    thickness = 1,\n  ): void {\n    thickness /= 2;\n    color = color.copy();\n    xCenter = Math.floor(xCenter);\n    yCenter = Math.floor(yCenter);\n\n    const drawCirclePixel = (x: number, y: number) => {\n      for (let i = -thickness / 2; i <= thickness / 2; i++) {\n        for (let j = -thickness / 2; j <= thickness / 2; j++) {\n          this.setPixel(Math.round(xCenter + x + i), Math.round(yCenter + y + j), color);\n        }\n      }\n    };\n\n    let x = radius;\n    let y = 0;\n    let err = 0;\n\n    while (x >= y) {\n      drawCirclePixel(x, y);\n      drawCirclePixel(y, x);\n      drawCirclePixel(-x, y);\n      drawCirclePixel(-y, x);\n      drawCirclePixel(-x, -y);\n      drawCirclePixel(-y, -x);\n      drawCirclePixel(x, -y);\n      drawCirclePixel(y, -x);\n\n      y++;\n      err += 1 + 2 * y;\n      if (2 * (err - x) + 1 > 0) {\n        x--;\n        err += 1 - 2 * x;\n      }\n    }\n  }\n\n  public fillCircle(xCenter: number, yCenter: number, radius: number, color: RgbColor): void {\n    xCenter = Math.floor(xCenter);\n    yCenter = Math.floor(yCenter);\n    color = color.copy();\n    for (let x = -radius; x <= radius; ++x) {\n      for (let y = -radius; y <= radius; ++y) {\n        if (x * x + y * y <= radius * radius) {\n          this.setPixel(xCenter + x, yCenter + y, color);\n        }\n      }\n    }\n  }\n\n  public strokeLightCircle(\n    xCenter: number,\n    yCenter: number,\n    radius: number,\n    intensity: number,\n    colorLightMap: ColorLightMap,\n    thickness = 1,\n  ): void {\n    this.dirty = true;\n\n    thickness /= 2;\n    xCenter = Math.floor(xCenter);\n    yCenter = Math.floor(yCenter);\n    radius = Math.floor(radius);\n\n    const applyLightAt = (x: number, y: number) => {\n      x = Math.floor(x);\n      y = Math.floor(y);\n      if (x < 0 || x >= this.width || y < 0 || y >= this.height) return;\n      const idx = y * this.width + x;\n      const dst = this.pixels[idx];\n      const lit = colorLightMap.resolve(dst, intensity);\n      dst.set(lit);\n    };\n\n    const lightCirclePixel = (x: number, y: number) => {\n      for (let i = -thickness / 2; i <= thickness / 2; i++) {\n        for (let j = -thickness / 2; j <= thickness / 2; j++) {\n          applyLightAt(Math.round(xCenter + x + i), Math.round(yCenter + y + j));\n        }\n      }\n    };\n\n    let x = radius;\n    let y = 0;\n    let err = 0;\n\n    while (x >= y) {\n      lightCirclePixel(x, y);\n      lightCirclePixel(y, x);\n      lightCirclePixel(-x, y);\n      lightCirclePixel(-y, x);\n      lightCirclePixel(-x, -y);\n      lightCirclePixel(-y, -x);\n      lightCirclePixel(x, -y);\n      lightCirclePixel(y, -x);\n\n      y++;\n      err += 1 + 2 * y;\n      if (2 * (err - x) + 1 > 0) {\n        x--;\n        err += 1 - 2 * x;\n      }\n    }\n  }\n\n  public fillLightCircle(\n    xCenter: number,\n    yCenter: number,\n    radius: number,\n    intensity: number,\n    colorLightMap: ColorLightMap,\n  ): void {\n    this.dirty = true;\n\n    xCenter = Math.floor(xCenter);\n    yCenter = Math.floor(yCenter);\n    radius = Math.floor(radius);\n\n    const applyLightAt = (x: number, y: number) => {\n      if (x < 0 || x >= this.width || y < 0 || y >= this.height) return;\n      const idx = y * this.width + x;\n      const dst = this.pixels[idx];\n      const lit = colorLightMap.resolve(dst, intensity);\n      dst.set(lit);\n    };\n\n    for (let x = -radius; x <= radius; ++x) {\n      for (let y = -radius; y <= radius; ++y) {\n        if (x * x + y * y <= radius * radius) {\n          applyLightAt(xCenter + x, yCenter + y);\n        }\n      }\n    }\n  }\n\n  public strokeOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    color: RgbColor,\n    thickness = 1,\n  ): void {\n    thickness /= 2;\n    color = color.copy();\n    xCenter = Math.floor(xCenter);\n    yCenter = Math.floor(yCenter);\n\n    const rx = Math.max(0, Math.floor(radiusX));\n    const ry = Math.max(0, Math.floor(radiusY));\n\n    if (rx === 0 && ry === 0) {\n      this.setPixel(xCenter, yCenter, color);\n      return;\n    }\n\n    const stamp = (dx: number, dy: number) => {\n      for (let i = -thickness / 2; i <= thickness / 2; i++) {\n        for (let j = -thickness / 2; j <= thickness / 2; j++) {\n          this.setPixel(xCenter + dx + Math.round(i), yCenter + dy + Math.round(j), color);\n        }\n      }\n    };\n\n    // Degenerate cases: line-like ovals\n    if (rx === 0) {\n      for (let y = -ry; y <= ry; y++) stamp(0, y);\n      return;\n    }\n    if (ry === 0) {\n      for (let x = -rx; x <= rx; x++) stamp(x, 0);\n      return;\n    }\n\n    const plot4 = (x: number, y: number) => {\n      stamp(x, y);\n      stamp(-x, y);\n      stamp(x, -y);\n      stamp(-x, -y);\n    };\n\n    const rx2 = rx * rx;\n    const ry2 = ry * ry;\n    const twoRx2 = 2 * rx2;\n    const twoRy2 = 2 * ry2;\n\n    let x = 0;\n    let y = ry;\n\n    let px = 0; // = 2*ry2*x\n    let py = twoRx2 * y; // = 2*rx2*y\n\n    // Region 1 decision parameter\n    let p1 = Math.round(ry2 - rx2 * ry + 0.25 * rx2);\n\n    while (px < py) {\n      plot4(x, y);\n\n      x++;\n      px += twoRy2;\n\n      if (p1 < 0) {\n        p1 += ry2 + px;\n      } else {\n        y--;\n        py -= twoRx2;\n        p1 += ry2 + px - py;\n      }\n    }\n\n    // Region 2 decision parameter\n    let p2 = Math.round(ry2 * (x + 0.5) * (x + 0.5) + rx2 * (y - 1) * (y - 1) - rx2 * ry2);\n\n    while (y >= 0) {\n      plot4(x, y);\n\n      y--;\n      py -= twoRx2;\n\n      if (p2 > 0) {\n        p2 += rx2 - py;\n      } else {\n        x++;\n        px += twoRy2;\n        p2 += rx2 - py + px;\n      }\n    }\n  }\n\n  public fillOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    color: RgbColor,\n  ): void {\n    xCenter = Math.floor(xCenter);\n    yCenter = Math.floor(yCenter);\n    color = color.copy();\n\n    const rx = Math.max(0, Math.floor(radiusX));\n    const ry = Math.max(0, Math.floor(radiusY));\n\n    if (rx === 0 && ry === 0) {\n      this.setPixel(xCenter, yCenter, color);\n      return;\n    }\n\n    // Degenerate cases: line-like ovals\n    if (rx === 0) {\n      for (let y = -ry; y <= ry; y++) this.setPixel(xCenter, yCenter + y, color);\n      return;\n    }\n    if (ry === 0) {\n      for (let x = -rx; x <= rx; x++) this.setPixel(xCenter + x, yCenter, color);\n      return;\n    }\n\n    // Build max x-extent for each |y| using midpoint ellipse, then fill scanlines.\n    const xMaxByY = new Array<number>(ry + 1).fill(0);\n\n    const rx2 = rx * rx;\n    const ry2 = ry * ry;\n    const twoRx2 = 2 * rx2;\n    const twoRy2 = 2 * ry2;\n\n    let x = 0;\n    let y = ry;\n\n    let px = 0;\n    let py = twoRx2 * y;\n\n    let p1 = Math.round(ry2 - rx2 * ry + 0.25 * rx2);\n\n    const mark = (x: number, y: number) => {\n      const ay = Math.abs(y);\n      if (ay <= ry && x > xMaxByY[ay]) xMaxByY[ay] = x;\n    };\n\n    while (px < py) {\n      mark(x, y);\n\n      x++;\n      px += twoRy2;\n\n      if (p1 < 0) {\n        p1 += ry2 + px;\n      } else {\n        y--;\n        py -= twoRx2;\n        p1 += ry2 + px - py;\n      }\n    }\n\n    let p2 = Math.round(ry2 * (x + 0.5) * (x + 0.5) + rx2 * (y - 1) * (y - 1) - rx2 * ry2);\n\n    while (y >= 0) {\n      mark(x, y);\n\n      y--;\n      py -= twoRx2;\n\n      if (p2 > 0) {\n        p2 += rx2 - py;\n      } else {\n        x++;\n        px += twoRy2;\n        p2 += rx2 - py + px;\n      }\n    }\n\n    // Fill horizontal scanlines using the extents we collected.\n    for (let dy = 0; dy <= ry; dy++) {\n      const xMax = xMaxByY[dy];\n      for (let dx = -xMax; dx <= xMax; dx++) {\n        this.setPixel(xCenter + dx, yCenter + dy, color);\n        if (dy !== 0) this.setPixel(xCenter + dx, yCenter - dy, color);\n      }\n    }\n  }\n\n  public strokeLightOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    intensity: number,\n    colorLightMap: ColorLightMap,\n    thickness = 1,\n  ): void {\n    this.dirty = true;\n\n    thickness /= 2;\n    xCenter = Math.floor(xCenter);\n    yCenter = Math.floor(yCenter);\n\n    const rx = Math.max(0, Math.floor(radiusX));\n    const ry = Math.max(0, Math.floor(radiusY));\n\n    const applyLightAt = (x: number, y: number) => {\n      if (x < 0 || x >= this.width || y < 0 || y >= this.height) return;\n      const idx = y * this.width + x;\n      const dst = this.pixels[idx];\n      const lit = colorLightMap.resolve(dst, intensity);\n      dst.set(lit);\n    };\n\n    const stampLight = (dx: number, dy: number) => {\n      for (let i = -thickness / 2; i <= thickness / 2; i++) {\n        for (let j = -thickness / 2; j <= thickness / 2; j++) {\n          applyLightAt(xCenter + dx + Math.round(i), yCenter + dy + Math.round(j));\n        }\n      }\n    };\n\n    if (rx === 0 && ry === 0) {\n      applyLightAt(xCenter, yCenter);\n      return;\n    }\n\n    // Degenerate cases: line-like ovals\n    if (rx === 0) {\n      for (let y = -ry; y <= ry; y++) stampLight(0, y);\n      return;\n    }\n    if (ry === 0) {\n      for (let x = -rx; x <= rx; x++) stampLight(x, 0);\n      return;\n    }\n\n    const plot4 = (x: number, y: number) => {\n      stampLight(x, y);\n      stampLight(-x, y);\n      stampLight(x, -y);\n      stampLight(-x, -y);\n    };\n\n    const rx2 = rx * rx;\n    const ry2 = ry * ry;\n    const twoRx2 = 2 * rx2;\n    const twoRy2 = 2 * ry2;\n\n    let x = 0;\n    let y = ry;\n\n    let px = 0; // = 2*ry2*x\n    let py = twoRx2 * y; // = 2*rx2*y\n\n    // Region 1\n    let p1 = Math.round(ry2 - rx2 * ry + 0.25 * rx2);\n\n    while (px < py) {\n      plot4(x, y);\n\n      x++;\n      px += twoRy2;\n\n      if (p1 < 0) {\n        p1 += ry2 + px;\n      } else {\n        y--;\n        py -= twoRx2;\n        p1 += ry2 + px - py;\n      }\n    }\n\n    // Region 2\n    let p2 = Math.round(ry2 * (x + 0.5) * (x + 0.5) + rx2 * (y - 1) * (y - 1) - rx2 * ry2);\n\n    while (y >= 0) {\n      plot4(x, y);\n\n      y--;\n      py -= twoRx2;\n\n      if (p2 > 0) {\n        p2 += rx2 - py;\n      } else {\n        x++;\n        px += twoRy2;\n        p2 += rx2 - py + px;\n      }\n    }\n  }\n\n  public fillLightOval(\n    xCenter: number,\n    yCenter: number,\n    radiusX: number,\n    radiusY: number,\n    intensity: number,\n    colorLightMap: ColorLightMap,\n  ): void {\n    this.dirty = true;\n\n    xCenter = Math.floor(xCenter);\n    yCenter = Math.floor(yCenter);\n\n    const rx = Math.max(0, Math.floor(radiusX));\n    const ry = Math.max(0, Math.floor(radiusY));\n\n    const applyLightAt = (x: number, y: number) => {\n      if (x < 0 || x >= this.width || y < 0 || y >= this.height) return;\n      const idx = y * this.width + x;\n      const dst = this.pixels[idx];\n      const lit = colorLightMap.resolve(dst, intensity);\n      dst.set(lit);\n    };\n\n    if (rx === 0 && ry === 0) {\n      applyLightAt(xCenter, yCenter);\n      return;\n    }\n\n    // Degenerate cases: line-like ovals\n    if (rx === 0) {\n      for (let y = -ry; y <= ry; y++) applyLightAt(xCenter, yCenter + y);\n      return;\n    }\n    if (ry === 0) {\n      for (let x = -rx; x <= rx; x++) applyLightAt(xCenter + x, yCenter);\n      return;\n    }\n\n    // Use midpoint ellipse to compute x-extents per |y|, then fill scanlines.\n    const xMaxByY = new Array<number>(ry + 1).fill(0);\n\n    const rx2 = rx * rx;\n    const ry2 = ry * ry;\n    const twoRx2 = 2 * rx2;\n    const twoRy2 = 2 * ry2;\n\n    let x = 0;\n    let y = ry;\n\n    let px = 0;\n    let py = twoRx2 * y;\n\n    let p1 = Math.round(ry2 - rx2 * ry + 0.25 * rx2);\n\n    const mark = (x: number, y: number) => {\n      const ay = Math.abs(y);\n      if (ay <= ry && x > xMaxByY[ay]) xMaxByY[ay] = x;\n    };\n\n    while (px < py) {\n      mark(x, y);\n\n      x++;\n      px += twoRy2;\n\n      if (p1 < 0) {\n        p1 += ry2 + px;\n      } else {\n        y--;\n        py -= twoRx2;\n        p1 += ry2 + px - py;\n      }\n    }\n\n    let p2 = Math.round(ry2 * (x + 0.5) * (x + 0.5) + rx2 * (y - 1) * (y - 1) - rx2 * ry2);\n\n    while (y >= 0) {\n      mark(x, y);\n\n      y--;\n      py -= twoRx2;\n\n      if (p2 > 0) {\n        p2 += rx2 - py;\n      } else {\n        x++;\n        px += twoRy2;\n        p2 += rx2 - py + px;\n      }\n    }\n\n    // Fill scanlines (apply lighting, don't overwrite)\n    for (let dy = 0; dy <= ry; dy++) {\n      const xMax = xMaxByY[dy];\n      const y1 = yCenter + dy;\n      const y2 = yCenter - dy;\n\n      for (let dx = -xMax; dx <= xMax; dx++) {\n        applyLightAt(xCenter + dx, y1);\n        if (dy !== 0) applyLightAt(xCenter + dx, y2);\n      }\n    }\n  }\n\n  public drawLine(\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    color: RgbColor,\n    thickness = 1,\n  ): void {\n    const halfThickness = Math.floor((thickness - 1) / 2);\n\n    for (let i = -halfThickness; i <= halfThickness; ++i) {\n      for (let j = -halfThickness; j <= halfThickness; ++j) {\n        this.drawLineSimple(x1 + i, y1 + j, x2 + i, y2 + j, color);\n      }\n    }\n  }\n\n  public strokeArc(\n    xCenter: number,\n    yCenter: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    color: RgbColor,\n    thickness = 1,\n  ): void {\n    // thickness /= 2;\n    thickness *= 0.8;\n    color = color.copy();\n    xCenter = Math.floor(xCenter);\n    yCenter = Math.floor(yCenter);\n\n    const drawCirclePixel = (x: number, y: number) => {\n      for (let i = -thickness / 2; i <= thickness / 2; i++) {\n        for (let j = -thickness / 2; j <= thickness / 2; j++) {\n          this.setPixel(Math.round(xCenter + x + i), Math.round(yCenter + y + j), color);\n        }\n      }\n    };\n\n    const angleInRange = (angle: number, start: number, end: number): boolean => {\n      angle = (angle + 2 * Math.PI) % (2 * Math.PI);\n      start = (start + 2 * Math.PI) % (2 * Math.PI);\n      end = (end + 2 * Math.PI) % (2 * Math.PI);\n      return (angle >= start && angle <= end) || (start > end && (angle >= start || angle <= end));\n    };\n\n    // Convert angles to radians\n    startAngle = (startAngle * Math.PI) / 180;\n    endAngle = (endAngle * Math.PI) / 180;\n\n    let x = radius;\n    let y = 0;\n    let err = 0;\n\n    while (x >= y) {\n      const points = [\n        [x, y],\n        [y, x],\n        [-x, y],\n        [-y, x],\n        [-x, -y],\n        [-y, -x],\n        [x, -y],\n        [y, -x],\n      ];\n\n      points.forEach(([px, py]) => {\n        const angle = Math.atan2(py, px);\n        if (angleInRange(angle, startAngle, endAngle)) {\n          drawCirclePixel(px, py);\n        }\n      });\n\n      y++;\n      err += 1 + 2 * y;\n      if (2 * (err - x) + 1 > 0) {\n        x--;\n        err += 1 - 2 * x;\n      }\n    }\n  }\n\n  public fillArc(\n    xCenter: number,\n    yCenter: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    color: RgbColor,\n  ): void {\n    color = color.copy();\n    xCenter = Math.floor(xCenter);\n    yCenter = Math.floor(yCenter);\n\n    const angleInRange = (angle: number, start: number, end: number): boolean => {\n      angle = (angle + 2 * Math.PI) % (2 * Math.PI);\n      start = (start + 2 * Math.PI) % (2 * Math.PI);\n      end = (end + 2 * Math.PI) % (2 * Math.PI);\n      return (angle >= start && angle <= end) || (start > end && (angle >= start || angle <= end));\n    };\n\n    // Convert angles to radians\n    startAngle = (startAngle * Math.PI) / 180;\n    endAngle = (endAngle * Math.PI) / 180;\n\n    for (let y = -radius; y <= radius; y++) {\n      for (let x = -radius; x <= radius; x++) {\n        const distance = Math.sqrt(x * x + y * y);\n        const angle = Math.atan2(y, x);\n\n        if (distance <= radius && angleInRange(angle, startAngle, endAngle)) {\n          this.setPixel(xCenter + x, yCenter + y, color);\n        }\n      }\n    }\n  }\n\n  private drawLineSimple(\n    rawX1: number,\n    rawY1: number,\n    rawX2: number,\n    rawY2: number,\n    color: RgbColor,\n  ): void {\n    let x1 = Math.round(rawX1);\n    let y1 = Math.round(rawY1);\n    const x2 = Math.round(rawX2);\n    const y2 = Math.round(rawY2);\n\n    const dx = Math.abs(x2 - x1);\n    const dy = Math.abs(y2 - y1);\n    const sx = x1 < x2 ? 1 : -1;\n    const sy = y1 < y2 ? 1 : -1;\n    let err = dx - dy;\n\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      this.setPixel(x1, y1, color);\n      if (x1 === x2 && y1 === y2) break;\n\n      const e2 = err * 2;\n      if (e2 > -dy) {\n        err -= dy;\n        x1 += sx;\n      }\n      if (e2 < dx) {\n        err += dx;\n        y1 += sy;\n      }\n    }\n  }\n\n  public getRawData(): RgbColorArray {\n    return this.pixels;\n  }\n}\n","import { ColorFilter } from './ColorFilter';\n\nexport class GraphicsProperties {\n  constructor(\n    public width: number,\n    public height: number,\n    public defaultColorFilter: ColorFilter,\n  ) {}\n}\n","import { AUDIO } from '../audio/Audio';\nimport { CAMERA } from '../graphics/Camera';\nimport { CanvasRenderer } from '../graphics/CanvasRenderer';\nimport { GraphicsProperties } from '../graphics/GraphicsProperties';\nimport { Game } from './Game';\nimport { INPUT } from './Input';\n\nexport class GameDriver {\n  private renderer: CanvasRenderer;\n  private game: Game;\n\n  private targetFPS = 60;\n  private targetFrameDuration: number = 1000 / this.targetFPS;\n\n  private lastTime: number = -1;\n  private running: boolean = false;\n\n  constructor(game: Game, renderer: CanvasRenderer) {\n    this.game = game;\n    this.renderer = renderer;\n    CAMERA.width = renderer.properties.width;\n    CAMERA.height = renderer.properties.height;\n    this.loop = this.loop.bind(this);\n  }\n\n  public getRenderProperties(): GraphicsProperties {\n    return this.renderer.properties;\n  }\n\n  public setRenderer(renderer: CanvasRenderer) {\n    this.renderer = renderer;\n    CAMERA.width = renderer.properties.width;\n    CAMERA.height = renderer.properties.height;\n  }\n\n  private update(): void {\n    this.game.onUpdate();\n  }\n\n  private draw(): void {\n    this.game.onDraw(this.renderer);\n    this.renderer.render();\n  }\n\n  private loop(): void {\n    this.update();\n    AUDIO.update();\n    INPUT.update();\n    this.draw();\n  }\n\n  public start(): void {\n    this.game.onStart();\n    this.running = true;\n    this.STEP(performance.now());\n  }\n\n  public stop(): void {\n    this.running = false;\n  }\n\n  public pause(): void {\n    this.running = false;\n  }\n\n  public resume(): void {\n    this.running = true;\n    this.lastTime = -1;\n    requestAnimationFrame(this.STEP.bind(this));\n  }\n\n  private STEP(timestamp: number) {\n    if (this.lastTime < 0) {\n      this.lastTime = timestamp;\n    }\n    let deltaTime = timestamp - this.lastTime;\n\n    // 1000/60 approximately equals 16.67\n    const t = 16.667;\n    if (deltaTime >= t) {\n      while (deltaTime >= t) {\n        this.loop();\n        deltaTime -= t;\n      }\n      this.lastTime = timestamp - deltaTime;\n    }\n\n    if (this.running) {\n      requestAnimationFrame(this.STEP.bind(this));\n    }\n  }\n\n  public pressUp() {\n    INPUT.setUp(true);\n  }\n\n  public liftUp() {\n    INPUT.setUp(false);\n  }\n\n  public pressDown() {\n    INPUT.setDown(true);\n  }\n\n  public liftDown() {\n    INPUT.setDown(false);\n  }\n\n  public pressLeft() {\n    INPUT.setLeft(true);\n  }\n\n  public liftLeft() {\n    INPUT.setLeft(false);\n  }\n\n  public pressRight() {\n    INPUT.setRight(true);\n  }\n\n  public liftRight() {\n    INPUT.setRight(false);\n  }\n\n  public pressZ() {\n    INPUT.setZ(true);\n  }\n\n  public liftZ() {\n    INPUT.setZ(false);\n  }\n\n  public pressA() {\n    INPUT.setA(true);\n  }\n\n  public liftA() {\n    INPUT.setA(false);\n  }\n\n  public pressB() {\n    INPUT.setB(true);\n  }\n\n  public liftB() {\n    INPUT.setB(false);\n  }\n\n  public pressC() {\n    INPUT.setC(true);\n  }\n\n  public liftC() {\n    INPUT.setC(false);\n  }\n\n  public pressD() {\n    INPUT.setD(true);\n  }\n\n  public liftD() {\n    INPUT.setD(false);\n  }\n}\n","export class Timer {\n  private maxTime: number;\n  private currentTime: number;\n  constructor(\n    time: number,\n    public onFinish: () => void = () => {},\n    public doesRepeat = true,\n    public startPrimed = true,\n  ) {\n    this.maxTime = time;\n    if (startPrimed) {\n      this.currentTime = time;\n    } else {\n      this.currentTime = 0;\n    }\n  }\n  update() {\n    if (this.currentTime <= 0 && !this.doesRepeat) return;\n\n    this.currentTime -= 1;\n    if (this.currentTime == 0) {\n      this.onFinish();\n    }\n    if (this.currentTime <= 0) {\n      if (this.doesRepeat) {\n        this.currentTime = this.maxTime;\n      }\n    }\n  }\n  stop() {\n    this.currentTime = 0;\n  }\n  reset() {\n    this.currentTime = this.maxTime;\n  }\n  setMaxTime(time: number) {\n    this.maxTime = Math.round(time);\n  }\n  getFrame(): number {\n    return this.currentTime;\n  }\n  isRunning(): boolean {\n    return this.currentTime > 0;\n  }\n}\n","import { RgbColor } from './RgbColor';\n\nexport class GameGraphics {\n  static createPixelArray(width: number, height: number): RgbColorArray {\n    const colors: RgbColorArray = [];\n    for (let i = 0; i < width * height; i++) {\n      colors.push(new RgbColor());\n    }\n    return colors;\n  }\n}\n\nexport type RgbColorArray = RgbColor[];\n","export class Note {\n  constructor(\n    public frequency: number,\n    public duration: number,\n    public gain: number,\n    public slideFrequency = false,\n    public slideGain = false,\n  ) {}\n}\n\nexport const MusicNotes: { [key: string]: number } = {\n  R: 0,\n  C0: 16.35,\n  CS0: 17.32,\n  D0: 18.35,\n  DS0: 19.45,\n  E0: 20.6,\n  F0: 21.83,\n  FS0: 23.12,\n  G0: 24.5,\n  GS0: 25.96,\n  A0: 27.5,\n  AS0: 29.14,\n  B0: 30.87,\n  C1: 32.7,\n  CS1: 34.65,\n  D1: 36.71,\n  DS1: 38.89,\n  E1: 41.2,\n  F1: 43.65,\n  FS1: 46.25,\n  G1: 49.0,\n  GS1: 51.91,\n  A1: 55.0,\n  AS1: 58.27,\n  B1: 61.74,\n  C2: 65.41,\n  CS2: 69.3,\n  D2: 73.42,\n  DS2: 77.78,\n  E2: 82.41,\n  F2: 87.31,\n  FS2: 92.5,\n  G2: 98.0,\n  GS2: 103.83,\n  A2: 110.0,\n  AS2: 116.54,\n  B2: 123.47,\n  C3: 130.81,\n  CS3: 138.59,\n  D3: 146.83,\n  DS3: 155.56,\n  E3: 164.81,\n  F3: 174.61,\n  FS3: 185.0,\n  G3: 196.0,\n  GS3: 207.65,\n  A3: 220.0,\n  AS3: 233.08,\n  B3: 246.94,\n  C4: 261.63,\n  CS4: 277.18,\n  D4: 293.66,\n  DS4: 311.13,\n  E4: 329.63,\n  F4: 349.23,\n  FS4: 369.99,\n  G4: 392.0,\n  GS4: 415.3,\n  A4: 440.0,\n  AS4: 466.16,\n  B4: 493.88,\n  C5: 523.25,\n  CS5: 554.37,\n  D5: 587.33,\n  DS5: 622.25,\n  E5: 659.26,\n  F5: 698.46,\n  FS5: 739.99,\n  G5: 783.99,\n  GS5: 830.61,\n  A5: 880.0,\n  AS5: 932.33,\n  B5: 987.77,\n  C6: 1046.5,\n  CS6: 1108.73,\n  D6: 1174.66,\n  DS6: 1244.51,\n  E6: 1318.51,\n  F6: 1396.91,\n  FS6: 1479.98,\n  G6: 1567.98,\n  GS6: 1661.22,\n  A6: 1760.0,\n  AS6: 1864.66,\n  B6: 1975.53,\n  C7: 2093.0,\n  CS7: 2217.46,\n  D7: 2349.32,\n  DS7: 2489.02,\n  E7: 2637.02,\n  F7: 2793.83,\n  FS7: 2959.96,\n  G7: 3135.96,\n  GS7: 3322.44,\n  A7: 3520.0,\n  AS7: 3729.31,\n  B7: 3951.07,\n  C8: 4186.01,\n  CS8: 4434.92,\n  D8: 4698.64,\n  DS8: 4978.03,\n  E8: 5274.04,\n  F8: 5587.65,\n  FS8: 5919.91,\n  G8: 6271.93,\n  GS8: 6644.88,\n  A8: 7040.0,\n  AS8: 7458.62,\n  B8: 7902.13,\n  C9: 8372.02,\n  CS9: 8869.84,\n  D9: 9397.28,\n  DS9: 9956.06,\n  E9: 10548.08,\n  F9: 11175.3,\n  FS9: 11839.82,\n  G9: 12543.86,\n  GS9: 13289.76,\n  A9: 14080.0,\n  AS9: 14917.24,\n  B9: 15804.26,\n  C10: 16744.04,\n  CS10: 17739.68,\n  D10: 18794.56,\n  DS10: 19912.12,\n  E10: 21096.16,\n  F10: 22350.6,\n  FS10: 23679.64,\n  G10: 25087.72,\n  GS10: 26579.52,\n  A10: 28160.0,\n  AS10: 29834.48,\n  B10: 31608.52,\n} as const;\n","import { RgbColor } from '../graphics/RgbColor';\nimport { Collision } from '../physics/Collision';\nimport { Point3 } from '../physics/Point';\nimport { ArgumentSet } from './ArgumentSet';\nimport { Component } from './Component';\nimport { destroy, GAME, instantiate } from './Game';\nimport { Lifecycle } from './Lifecycle';\n\n/**\n * The basic Game Object used to represent a movable object on the screen.\n *\n * The @function setSize function is used with @function setDimensions to\n * compute the collision bounds.\n *\n * Store arbitrary game state data in the @property {extra} field\n *\n */\nexport class GameObject extends Lifecycle {\n  private static instanceId = 0;\n  private instance = -1;\n  private _isDestroyed = false;\n  _markDestroyed() {\n    this._isDestroyed = true;\n  }\n\n  public get isDestroyed() {\n    return this._isDestroyed;\n  }\n\n  public DEBUG = false;\n  public DEBUG_COLOR = RgbColor.red;\n\n  public x = 0;\n  public y = 0;\n  public z = 0;\n\n  public orderInLayer = 0;\n\n  public vx = 0; // Pixels per frame\n  public vy = 0;\n  public m = 1;\n  public linearDampingX = 0.9;\n  public linearDampingY = 0.9;\n\n  public width = 0;\n  public height = 0;\n  public colliderOffsetX = 0;\n  public colliderOffsetY = 0;\n  public ignoresCollision = true;\n\n  private components: Component[] = [];\n\n  public setSize(n: number): void {\n    this.setDimensions(n, n);\n  }\n\n  public setDimensions(w: number, h: number) {\n    this.width = w;\n    this.height = h;\n    this.colliderOffsetX = w / 2;\n    this.colliderOffsetY = h / 2;\n  }\n\n  public setColliderOffsets(x: number, y: number) {\n    this.colliderOffsetX = x;\n    this.colliderOffsetY = y;\n    this.ignoresCollision = false;\n  }\n\n  public extra: ArgumentSet = {};\n  constructor(public name: string) {\n    super();\n    this.instance = GameObject.instanceId;\n    GameObject.instanceId += 1;\n  }\n\n  public instanceId(): number {\n    return this.instance;\n  }\n\n  /** Components */\n\n  public getComponents<T extends Component>(\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type: new (...args: any[]) => T,\n  ): T[];\n  public getComponents(): Component[];\n  public getComponents<T extends Component>(\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    type?: new (...args: any[]) => T,\n  ): (T | Component)[] {\n    if (type) {\n      return this.components.filter((component) => component instanceof type) as T[];\n    }\n    return this.components;\n  }\n\n  public addComponent(component: Component) {\n    component.attach(this);\n    this.components.push(component);\n  }\n\n  removeComponent(component: Component): boolean;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  removeComponent<T extends Component>(type: new (...args: any[]) => T): T[];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  removeComponent(arg: Component | (new (...args: any[]) => Component)): boolean | Component[] {\n    if (typeof arg === 'function') {\n      const removed: Component[] = [];\n      for (let i = this.components.length - 1; i >= 0; i--) {\n        if (this.components[i] instanceof arg) {\n          removed.push(this.components[i]);\n          this.components.splice(i, 1);\n        }\n      }\n      return removed;\n    } else {\n      const index = this.components.indexOf(arg);\n      if (index !== -1) {\n        this.components.splice(index, 1);\n        return true;\n      }\n      return false;\n    }\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public getComponent<T extends Component>(type: new (...args: any[]) => T): T | undefined {\n    return this.components.find((component) => component instanceof type) as T | undefined;\n  }\n\n  /** Movement and collision */\n\n  public canCollideWith: (other: GameObject) => boolean = () => true;\n\n  // public move(nx: number, ny: number, speed: number | null = null, revertSlide = false): boolean {\n  //   const oldX = this.x;\n  //   const oldY = this.y;\n  //   this.x = nx;\n  //   this.y = ny;\n  //   if (this.ignoresCollision) return false;\n  //   let reverted = false;\n  //   const walls = GAME.current.getFilteredObjects(\n  //     (go: GameObject) => go != this && !go.ignoresCollision && this.canCollideWith(go),\n  //   );\n  //   for (let i = 0; i < walls.length; i++) {\n  //     if (Collision.checkIfObjectsCollide(walls[i], this)) {\n  //       this.x = oldX;\n  //       this.y = oldY;\n  //       reverted = true;\n  //       break;\n  //     }\n  //   }\n  //   if (revertSlide) {\n  //     if (reverted) {\n  //       const xdir = nx - this.x >= 0 ? 1 : -1;\n  //       if (speed != null) {\n  //         this.x += speed * xdir;\n  //       } else {\n  //         this.x = nx;\n  //       }\n  //       reverted = false;\n  //       for (let i = 0; i < walls.length; i++) {\n  //         if (Collision.checkIfObjectsCollide(walls[i], this)) {\n  //           this.x = oldX;\n  //           this.y = oldY;\n  //           reverted = true;\n  //           break;\n  //         }\n  //       }\n  //     }\n  //     if (reverted) {\n  //       const ydir = ny - this.y >= 0 ? 1 : -1;\n  //       if (speed != null) {\n  //         this.y += speed * ydir;\n  //       } else {\n  //         this.y = ny;\n  //       }\n  //       reverted = false;\n  //       for (let i = 0; i < walls.length; i++) {\n  //         if (Collision.checkIfObjectsCollide(walls[i], this)) {\n  //           this.x = oldX;\n  //           this.y = oldY;\n  //           break;\n  //         }\n  //       }\n  //     }\n  //   }\n  //   return reverted;\n  // }\n\n  // public move(nx: number, ny: number): boolean {\n  //   const oldX = this.x;\n  //   const oldY = this.y;\n  //   this.x = nx;\n  //   this.y = ny;\n  //   if (this.ignoresCollision) return false;\n  //   let reverted = false;\n  //   const walls = GAME.current.getFilteredObjects(\n  //     (go: GameObject) => go != this && !go.ignoresCollision && this.canCollideWith(go),\n  //   );\n  //   for (let i = 0; i < walls.length; i++) {\n  //     if (Collision.checkIfObjectsCollide(walls[i], this)) {\n  //       this.x = oldX;\n  //       this.y = oldY;\n  //       reverted = true;\n  //       break;\n  //     }\n  //   }\n  //   return reverted;\n  // }\n\n  public move(nx: number, ny: number): boolean {\n    // const oldX = this.x;\n    // const oldY = this.y;\n\n    this.x = nx;\n    this.y = ny;\n    if (this.ignoresCollision) return false;\n\n    const walls = GAME.current.getFilteredObjects(\n      (go) =>\n        go !== this && !go.ignoresCollision && this.canCollideWith(go) && go.canCollideWith(this),\n    );\n\n    for (const w of walls) {\n      if (!Collision.checkIfObjectsCollide(w, this)) continue;\n\n      // ----- extents ---------------------------------------------------------\n      const leftA = this.x - this.colliderOffsetX;\n      const rightA = leftA + this.width;\n      const topA = this.y - this.colliderOffsetY;\n      const bottomA = topA + this.height;\n\n      const leftB = w.x - w.colliderOffsetX;\n      const rightB = leftB + w.width;\n      const topB = w.y - w.colliderOffsetY;\n      const bottomB = topB + w.height;\n\n      // ----- penetration depth (always  0) ----------------------------------\n      const penX = Math.min(rightA, rightB) - Math.max(leftA, leftB);\n      const penY = Math.min(bottomA, bottomB) - Math.max(topA, topB);\n\n      // ----- resolve along axis of least penetration -------------------------\n      if (penX < penY) {\n        // horizontal push: pick direction by comparing centres\n        const dir = this.x + this.width * 0.5 < w.x + w.width * 0.5 ? -1 : 1;\n        this.x += dir * penX;\n      } else {\n        // vertical push\n        const dir = this.y + this.height * 0.5 < w.y + w.height * 0.5 ? -1 : 1;\n        this.y += dir * penY;\n      }\n      return true; // resolved against this wall\n    }\n    return false; // no collision\n  }\n\n  static find(name: string): GameObject | null {\n    return GAME.current.findObjectByName(name);\n  }\n\n  static findById(id: number): GameObject | null {\n    return GAME.current.findObjectById(id);\n  }\n\n  static findObjects(filter: (go: GameObject) => boolean): GameObject[] {\n    return GAME.current.getFilteredObjects(filter);\n  }\n\n  static instantiate(object: GameObject, location?: Point3): GameObject {\n    return instantiate(object, location);\n  }\n\n  static destroy(object: GameObject): GameObject {\n    return destroy(object);\n  }\n}\n","export class Random {\n  static random(min: number, max: number): number {\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n  }\n\n  static coinflip(): boolean {\n    return Math.random() <= 0.5;\n  }\n\n  static randomItem<T>(array: T[]): T {\n    return array[Math.floor(Math.random() * array.length)];\n  }\n}\n","import { GameObject } from '../game/GameObject';\nimport { Direction } from './Direction';\nimport { Point } from './Point';\n\nexport class Vector {\n  static angleBetweenPoints(x1: number, y1: number, x2: number, y2: number): number {\n    const deltaY = y2 - y1;\n    const deltaX = x2 - x1;\n    const angleInRadians = Math.atan2(deltaY, deltaX);\n    let degrees = (angleInRadians * 180) / Math.PI;\n    if (degrees < 0) degrees += 360;\n    if (degrees >= 360) degrees -= 360;\n    return degrees;\n  }\n\n  static angleBetweenObjects(o1: GameObject, o2: GameObject): number {\n    return Vector.angleBetweenPoints(o1.x, o1.y, o2.x, o2.y);\n  }\n\n  static targetVector(dir: Direction): Point {\n    const targetX = dir.includes('w') ? -1 : dir.includes('e') ? 1 : 0;\n    const targetY = dir.includes('n') ? -1 : dir.includes('s') ? 1 : 0;\n    return Vector.unitVector(0, 0, targetX, targetY);\n  }\n\n  static unitVector(x1: number, y1: number, x2: number, y2: number): Point {\n    const pointA = new Point(x1, y1);\n    const pointB = new Point(x2, y2);\n    const vector = Point.subtractPoints(pointB, pointA); // Swap the order of subtraction\n    return vector.vectorNormalize();\n  }\n\n  static distanceSquared(x1: number, y1: number, x2: number, y2: number): number {\n    const dx = x1 - x2;\n    const dy = y1 - y2;\n    return dx * dx + dy * dy;\n  }\n}\n","import { DefaultAssets } from '../../assets/DefaultAssets';\nimport { AnimationSequence } from '../../graphics/Animation';\nimport { Bitmap } from '../../graphics/Bitmap';\n\nexport class NextCursor {\n  private animation = new AnimationSequence([DefaultAssets.ncursor_1, DefaultAssets.ncursor_2], 30);\n\n  public update(): void {\n    this.animation.update();\n  }\n\n  public get(): Bitmap {\n    return this.animation.get();\n  }\n}\n\nexport class SelectCursor {\n  private animation = new AnimationSequence([DefaultAssets.scursor_1, DefaultAssets.scursor_2], 30);\n\n  public update(): void {\n    this.animation.update();\n  }\n\n  public get(): Bitmap {\n    return this.animation.get();\n  }\n}\n","export class TimeUtil {\n  static formatMilliseconds(milliseconds: number): string {\n    const totalSeconds = Math.floor(milliseconds / 1000);\n    const minutes = Math.floor(totalSeconds / 60);\n    const seconds = totalSeconds % 60;\n\n    const formattedMinutes = String(minutes).padStart(2, '0');\n    const formattedSeconds = String(seconds).padStart(2, '0');\n\n    return `${formattedMinutes}:${formattedSeconds}`;\n  }\n}\n","import { PrefabDefinition } from '../game/PrefabDefinition';\nimport { AnimationKeySequence } from '../graphics/Animation';\nimport { Bitmap } from '../graphics/Bitmap';\nimport { ColorFilter } from '../graphics/ColorFilter';\nimport { ColorPalette } from '../graphics/ColorPalette';\nimport { RgbColor } from '../graphics/RgbColor';\nimport { Box } from '../physics/Box';\nimport { Font } from '../text/Font';\nimport { TextUtil } from '../text/TextUtil';\n\nexport interface AssetManager {\n  getBitmap(id: number): Bitmap;\n  getBitmapByName(id: string): Bitmap;\n  getFilter(id: number): ColorFilter | undefined;\n  getFilterByName(id: string): ColorFilter | undefined;\n  getMap(id: number, fallback?: RgbColor): MapAssetDefinition | undefined;\n  getMapByName(id: string): MapAssetDefinition | undefined;\n  getFilterByName(id: string): ColorFilter | undefined;\n  getAnimation(id: number): AnimationKeySequence | undefined;\n  getAnimationByName(id: string): AnimationKeySequence | undefined;\n  getFont(id: number): Font | undefined;\n  getFontByName(id: string): Font | undefined;\n}\n\nclass DummyAssetManager implements AssetManager {\n  getFont(id: number): Font | undefined {\n    throw new Error('Method not implemented. ' + id);\n  }\n  getFontByName(id: string): Font | undefined {\n    throw new Error('Method not implemented. ' + id);\n  }\n  getAnimation(id: number): AnimationKeySequence | undefined {\n    throw new Error('Method not implemented. ' + id);\n  }\n  getAnimationByName(id: string): AnimationKeySequence | undefined {\n    throw new Error('Method not implemented. ' + id);\n  }\n  getFilter(): ColorFilter {\n    throw new Error('Method not implemented.');\n  }\n  getFilterByName(): ColorFilter {\n    throw new Error('Method not implemented.');\n  }\n  getMap(): MapAssetDefinition | undefined {\n    return undefined;\n  }\n  getMapByName(): MapAssetDefinition | undefined {\n    return undefined;\n  }\n  getBitmap(): Bitmap {\n    throw 'NOT IMPLEMENTED getBitmap';\n  }\n  getBitmapByName(): Bitmap {\n    throw 'NOT IMPLEMENTED getBitmapByName';\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nclass LocalAssetManager {\n  private imgMap: { [key: number]: Bitmap } = {};\n  private fontMap: { [key: number]: Font } = {};\n  private audioMap: { [key: number]: string } = {};\n  private filterMap: { [key: number]: ColorFilter } = {};\n\n  public clear(): void {\n    this.imgMap = {};\n  }\n\n  public loadRleImage(key: number, data: string) {\n    this.imgMap[key] = TextUtil.rle64img(data);\n  }\n\n  public loadImage(key: number, image: Bitmap) {\n    this.imgMap[key] = image;\n  }\n\n  public getImage(key: number): Bitmap {\n    return this.imgMap[key];\n  }\n\n  public loadFont(key: number, font: Font) {\n    this.fontMap[key] = font;\n  }\n\n  public getFont(key: number): Font {\n    return this.fontMap[key];\n  }\n\n  public loadAudio(key: number, data: string) {\n    this.audioMap[key] = data;\n  }\n\n  public getAudio(key: number): string {\n    return this.audioMap[key];\n  }\n\n  public loadFilter(key: number, filter: ColorFilter) {\n    this.filterMap[key] = filter;\n  }\n\n  public getFilter(key: number): ColorFilter {\n    return this.filterMap[key];\n  }\n\n  // public loadAssets(assets: AssetFile) {\n  //   assets.drawable.forEach((item, index) => {\n  //     this.loadRleImage(index, item.data);\n  //   });\n  //   assets.palette.forEach((item, index) => {\n  //     this.loadFilter(index, ColorFilter.fromRgbArray(item.palette.colors));\n  //   });\n  // }\n}\n\n// export interface AssetFile {\n//   drawable: DrawableAssetDefinition[];\n//   palette: ColorPaletteAssetDefinition[];\n//   map: MapAssetDefinition[];\n// }\n\nexport interface DrawableAssetDefinition {\n  name: string;\n  data: string;\n  width: number;\n  height: number;\n  preferredFilter?: string;\n}\n\nexport interface ColorPaletteAssetDefinition {\n  name: string;\n  palette: ColorPalette;\n}\n\nexport interface MapAssetDefinition {\n  name: string;\n  data: string;\n  width: number;\n  height: number;\n  map: { [key: string]: MapTileDefinition };\n  colliders: Box[];\n  prefabs: PrefabDefinition[];\n}\n\nexport interface MapTileDefinition {\n  name?: string;\n  animated?: boolean;\n}\n\nexport function setAssetManager(assetManager: AssetManager) {\n  Assets = assetManager;\n}\n\nexport let Assets: AssetManager = new DummyAssetManager();\n","import { TextUtil } from '../text/TextUtil';\nimport { Rgb, RgbColor } from './RgbColor';\n\nexport class ColorFilter {\n  constructor(\n    public map: ColorFilterMap,\n    public fallbackColor: RgbColor,\n  ) {}\n\n  public copy(): ColorFilter {\n    return new ColorFilter({ ...this.map }, this.fallbackColor);\n  }\n\n  public get(c: string): RgbColor {\n    return this.map[c] ?? this.fallbackColor;\n  }\n\n  static monoChromeFilter: ColorFilter = new ColorFilter(\n    {\n      A: RgbColor.mc1,\n      B: RgbColor.mc2,\n      C: RgbColor.mc3,\n      D: RgbColor.mc4,\n    },\n    RgbColor.none,\n  );\n\n  static gameboyGreyscaleFilter: ColorFilter = new ColorFilter(\n    {\n      A: RgbColor.black,\n      B: RgbColor.gs2,\n      C: RgbColor.gs3,\n      D: RgbColor.white,\n    },\n    RgbColor.none,\n  );\n\n  static nostalgiaFilter: ColorFilter = new ColorFilter(\n    {\n      A: RgbColor.nostalgia4,\n      B: RgbColor.nostalgia3,\n      C: RgbColor.nostalgia2,\n      D: RgbColor.nostalgia1,\n    },\n    RgbColor.none,\n  );\n\n  static fromRgbArray(colors: Rgb[]): ColorFilter {\n    const colorMap: ColorFilterMap = {};\n    colors.map((item, index) => {\n      const char = TextUtil.BASE64[index];\n      colorMap[char] = new RgbColor(item.r, item.g, item.b);\n    });\n    return new ColorFilter(colorMap, RgbColor.none);\n  }\n}\n\ntype ColorFilterMap = {\n  [key: string]: RgbColor;\n};\n\nexport function monoColorFilter(color: RgbColor): ColorFilter {\n  return new ColorFilter({ _: RgbColor.none }, color);\n}\n","import { GAMEDRIVER } from '../../game/Game';\nimport { INPUT } from '../../game/Input';\nimport { Lifecycle } from '../../game/Lifecycle';\nimport { Bitmap } from '../../graphics/Bitmap';\nimport { CanvasRenderer } from '../../graphics/CanvasRenderer';\nimport { Font } from '../../text/Font';\nimport { Alignment } from '../Alignment';\nimport { List, ListItem } from '../DialogList';\nimport { Dialog } from './Dialog';\n\nexport class ListAlertDialog extends Lifecycle {\n  private dialog: Dialog;\n  private margin: number;\n  private x: number;\n  private y: number;\n  private width: number;\n  private height: number;\n  private list: List;\n\n  constructor(\n    public onDismiss: () => void,\n    public labels: ListItem[],\n    alignment: Alignment,\n    margin: number,\n    public padding: number,\n    width: number,\n    topLeftCorner: Bitmap,\n    verticalSidePiece: Bitmap,\n    public font: Font,\n    public kerning: number,\n    public lineSpacing: number,\n  ) {\n    super();\n    this.margin = margin;\n    width = width - margin * 2;\n\n    this.list = new List(labels);\n    const textHeight = labels\n      .map((n) => font.measure(n.label).height)\n      .reduce((a, b) => a + b + lineSpacing, 0);\n\n    let height = textHeight + 2 * topLeftCorner.height + 2 * padding;\n    height = Math.ceil(height / verticalSidePiece.height) * verticalSidePiece.height;\n\n    let y = margin;\n    const sh = GAMEDRIVER.current.getRenderProperties().height;\n    if (alignment == Alignment.CENTER) {\n      y = sh / 2 - height / 2;\n    } else if (alignment == Alignment.BOTTOM) {\n      y = sh - height - margin;\n    }\n\n    const sw = GAMEDRIVER.current.getRenderProperties().width;\n    const x = sw / 2 - width / 2;\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n\n    this.dialog = new Dialog(x, y, width, height, topLeftCorner, verticalSidePiece);\n  }\n\n  update = () => {\n    if (INPUT.getKeyDown('A') || INPUT.getKeyDown('B')) {\n      this.onDismiss();\n    }\n  };\n\n  drawUi = (r: CanvasRenderer) => {\n    this.dialog.drawUi(r);\n    const context = this.dialog.getRenderContext(\n      this.padding,\n      this.padding,\n      this.padding,\n      this.padding,\n    );\n\n    this.list.draw(\n      r,\n      context,\n      this.font,\n      this.kerning,\n      this.font.get(' ').height + this.lineSpacing,\n    );\n  };\n\n  public getMargin(): number {\n    return this.margin;\n  }\n\n  public getX(): number {\n    return this.x;\n  }\n\n  public getY(): number {\n    return this.y;\n  }\n\n  public getWidth(): number {\n    return this.width;\n  }\n\n  public getHeight(): number {\n    return this.height;\n  }\n}\n","import { AudioPlayer } from './Audio';\nimport { Note } from './Note';\n\nexport abstract class Instrument {\n  private DECAY_STEP = 0.015;\n  protected player: AudioPlayer | null = null;\n  protected oscillator: OscillatorNode | null = null;\n  protected gain: GainNode | null = null;\n  protected waveShaper: WaveShaperNode | null = null;\n  private notes: Note[] = [];\n  private currentIndex = 0;\n  private currentTimer = 0;\n  private playing = false;\n  private initialized = false;\n  private trackLength = 0;\n\n  public reset() {\n    this.currentIndex = 0;\n    this.playing = true;\n    this.loadNote();\n  }\n\n  public setTrack(notes: Note[]) {\n    this.currentIndex = 0;\n    this.trackLength = notes.reduce((sum, note) => sum + note.duration, 0);\n    this.notes = notes;\n  }\n\n  public destroy(): void {\n    this.oscillator = null;\n    this.gain = null;\n  }\n\n  public isDestroyed(): boolean {\n    return this.oscillator == null || this.gain == null;\n  }\n\n  initialize(audioContext: AudioContext, player: AudioPlayer) {\n    this.player = player;\n    this.innerInitialize(audioContext);\n  }\n  abstract innerInitialize(audioContext: AudioContext): void;\n\n  public start(): void {\n    if (this.notes.length > 0) {\n      if (!this.initialized) {\n        this.innerStart();\n      }\n\n      this.initialized = true;\n      this.playing = true;\n      this.loadNote();\n    }\n  }\n\n  public stop(): void {\n    // this.oscillator?.stop();\n    //this.playing = false;\n    this.setGain(0);\n    this.currentIndex = 0;\n  }\n\n  public set(frequency: number, gain: number): void {\n    this.setFrequency(frequency);\n    this.setGain(gain);\n  }\n\n  public setFrequency(frequency: number): void {\n    if (this.oscillator != null) {\n      this.oscillator.frequency.value = frequency;\n    }\n  }\n\n  public setGain(gain: number): void {\n    if (this.gain != null) {\n      this.gain.gain.value = gain;\n    }\n  }\n\n  public update() {\n    // if (AUDIO.isDonePlaying()) {\n    //   this.powerOff();\n    // }\n\n    if (this.playing) {\n      this.currentTimer -= 1;\n      if (this.currentTimer == 1) {\n        if (\n          !this.notes[this.currentIndex].slideFrequency &&\n          !this.notes[this.currentIndex].slideGain\n        ) {\n          this.powerDown();\n        }\n      } else if (this.currentTimer == 0) {\n        this.currentIndex += 1;\n        if (this.currentIndex >= this.notes.length) {\n          this.stop();\n          this.player?.setInstrumentAsDone(this);\n        } else {\n          this.loadNote();\n        }\n      }\n    }\n  }\n\n  public powerOff(): void {\n    if (this.playing) {\n      this.playing = false;\n      this.powerDown();\n    }\n  }\n\n  private powerDown(): void {\n    // console.log('POWER DOWN');\n    // Ramp down to silence\n    this.gain?.gain.setTargetAtTime(0, this.player?.getCurrentTime() ?? 0, this.DECAY_STEP);\n  }\n\n  private loadNote() {\n    if (!this.playing) return;\n\n    const note = this.notes[this.currentIndex];\n    this.currentTimer = note.duration;\n    this.setFrequency(note.frequency);\n    this.setGain(note.gain * (this.player?.getVolume() ?? 0));\n\n    if (note.slideFrequency) {\n      const next = this.notes[this.currentIndex + 1];\n      if (next) {\n        this.oscillator?.frequency.setTargetAtTime(\n          next.frequency,\n          this.player?.getCurrentTime() ?? 0,\n          note.duration / 60,\n        );\n      }\n    }\n    if (note.slideGain) {\n      const next = this.notes[this.currentIndex + 1];\n      if (next) {\n        this.gain?.gain.setTargetAtTime(\n          next.gain,\n          this.player?.getCurrentTime() ?? 0,\n          (note.duration / 60) * 0.3,\n        );\n      }\n    }\n\n    this.innerLoadNote(note);\n  }\n\n  abstract innerLoadNote(note: Note): void;\n  abstract innerStart(): void;\n}\n\nexport class SquareInstrument extends Instrument {\n  innerStart(): void {\n    this.oscillator?.start();\n  }\n\n  innerLoadNote(): void {\n    /** Unused */\n  }\n\n  public innerInitialize(audioContext: AudioContext) {\n    this.oscillator = audioContext.createOscillator();\n    this.oscillator.type = 'square';\n    this.oscillator.frequency.value = 0;\n    this.gain = audioContext.createGain();\n    this.gain.gain.value = 0.0;\n    this.oscillator.connect(this.gain);\n    this.gain.connect(audioContext.destination);\n  }\n}\n\nexport class PulseInstrument extends Instrument {\n  private real0 = new Float32Array(10);\n  private imag0 = new Float32Array(10);\n  private real1 = new Float32Array(10);\n  private imag1 = new Float32Array(10);\n  private real2 = new Float32Array(10);\n  private imag2 = new Float32Array(10);\n  private currentDuty = 0;\n\n  constructor() {\n    super();\n\n    let dutyCycle = 0.125;\n    for (let i = 1; i < this.real0.length; i++) {\n      this.real0[i] = (2 / (i * Math.PI)) * (1 - Math.cos(i * Math.PI * dutyCycle));\n      this.imag0[i] = -(2 / (i * Math.PI)) * Math.sin(i * Math.PI * dutyCycle);\n    }\n    dutyCycle = 0.25;\n    for (let i = 1; i < this.real1.length; i++) {\n      this.real1[i] = (2 / (i * Math.PI)) * (1 - Math.cos(i * Math.PI * dutyCycle));\n      this.imag1[i] = -(2 / (i * Math.PI)) * Math.sin(i * Math.PI * dutyCycle);\n    }\n    dutyCycle = 0.5;\n    for (let i = 1; i < this.real2.length; i++) {\n      this.real2[i] = (2 / (i * Math.PI)) * (1 - Math.cos(i * Math.PI * dutyCycle));\n      this.imag2[i] = -(2 / (i * Math.PI)) * Math.sin(i * Math.PI * dutyCycle);\n    }\n  }\n\n  innerStart(): void {\n    this.oscillator?.start();\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  innerLoadNote(note: Note): void {\n    this.loadDuty();\n  }\n\n  public innerInitialize(audioContext: AudioContext) {\n    this.oscillator = audioContext.createOscillator();\n    this.oscillator.frequency.value = 0;\n    this.gain = audioContext.createGain();\n    this.gain.gain.value = 0.0;\n    this.oscillator.connect(this.gain);\n    this.gain.connect(audioContext.destination);\n\n    this.loadDuty();\n  }\n\n  private loadDuty() {\n    const real =\n      this.currentDuty == 0 || this.currentDuty == 3\n        ? this.real2\n        : this.currentDuty == 1\n        ? this.real0\n        : this.real1;\n    const imag =\n      this.currentDuty == 0 || this.currentDuty == 3\n        ? this.imag2\n        : this.currentDuty == 1\n        ? this.imag0\n        : this.imag1;\n    if (this.player) {\n      const wave = this.player._createPeriodicWave(real, imag);\n      this.oscillator?.setPeriodicWave(wave);\n    }\n  }\n}\n\nexport class TriangleInstrument extends Instrument {\n  innerStart(): void {\n    this.oscillator?.start();\n  }\n\n  innerLoadNote(): void {\n    /** Unused */\n  }\n\n  public innerInitialize(audioContext: AudioContext) {\n    this.oscillator = audioContext.createOscillator();\n    this.oscillator.type = 'triangle';\n    this.oscillator.frequency.value = 0;\n    this.gain = audioContext.createGain();\n    this.gain.gain.value = 0.0;\n    this.oscillator.connect(this.gain);\n    this.gain.connect(audioContext.destination);\n  }\n}\n\nexport class NoiseInstrument extends Instrument {\n  private context: AudioContext | null = null;\n  private noise: AudioBufferSourceNode | null = null;\n  private filter: BiquadFilterNode | null = null;\n  private noiseBuffer: AudioBuffer | null = null;\n  private output: Float32Array = new Float32Array();\n\n  innerLoadNote(note: Note): void {\n    if (this.filter != null) {\n      // this.filter.type = note.duty == 0 ? 'lowpass' : 'highpass';\n      this.filter.type = 'lowpass';\n      this.filter.frequency.value = note.frequency;\n    }\n    if (\n      this.noiseBuffer != null &&\n      this.noise != null &&\n      this.context != null &&\n      this.filter != null &&\n      this.gain != null\n    ) {\n      this.noise.disconnect();\n      this.noise = this.context.createBufferSource();\n      this.noise.buffer = this.noiseBuffer;\n      this.noise.connect(this.filter).connect(this.gain);\n      this.noise.start();\n    }\n  }\n\n  innerStart(): void {\n    this.noise?.start();\n  }\n\n  public innerInitialize(audioContext: AudioContext) {\n    this.context = audioContext;\n    this.noiseBuffer = audioContext.createBuffer(\n      1,\n      audioContext.sampleRate * 5,\n      audioContext.sampleRate,\n    );\n    this.output = this.noiseBuffer.getChannelData(0);\n    this.filter = audioContext.createBiquadFilter();\n    this.filter.type = 'lowpass';\n    this.filter.frequency.value = 0;\n\n    for (let i = 0; i < this.output.length; i++) {\n      this.output[i] = Math.random() * 2 - 1;\n    }\n\n    this.noise = audioContext.createBufferSource();\n    this.noise.buffer = this.noiseBuffer;\n\n    this.gain = audioContext.createGain();\n    this.gain.gain.value = 0.5;\n    this.noise.connect(this.filter).connect(this.gain);\n    this.gain.connect(audioContext.destination);\n  }\n}\n","export * from './assets/Assets';\nexport * from './assets/DefaultAssets';\n\nexport * from './audio/Audio';\nexport * from './audio/AudioParser';\nexport * from './audio/Instrument';\nexport * from './audio/Note';\n\nexport * from './game/ArgumentSet';\nexport * from './game/BackgroundData';\nexport * from './game/BuildConfig';\nexport * from './game/Component';\nexport * from './game/Decoration';\nexport * from './game/Game';\nexport * from './game/GameDriver';\nexport * from './game/GameObject';\nexport * from './game/Input';\nexport * from './game/Joystick';\nexport * from './game/Lifecycle';\nexport * from './game/PrefabDefinition';\nexport * from './game/Scene';\nexport * from './game/Timer';\nexport * from './game/component/DestroyTimer';\n\nexport * from './graphics/Animation';\nexport * from './graphics/Bitmap';\nexport * from './graphics/Camera';\nexport * from './graphics/CanvasRenderer';\nexport * from './graphics/ColorFilter';\nexport * from './graphics/ColorLightMap';\nexport * from './graphics/ColorPalette';\nexport * from './graphics/GameGraphics';\nexport * from './graphics/GraphicsProperties';\nexport * from './graphics/Pixels';\nexport * from './graphics/RgbColor';\n\nexport * from './physics/Box';\nexport * from './physics/Collision';\nexport * from './physics/Direction';\nexport * from './physics/Point';\nexport * from './physics/Vector';\n\nexport * from './text/Font';\nexport * from './text/TextUtil';\n\nexport * from './ui/components/Cursor';\nexport * from './ui/components/SelectionCarousel';\nexport * from './ui/dialog/AlertChoiceDialog';\nexport * from './ui/dialog/AlertDialog';\nexport * from './ui/dialog/Dialog';\nexport * from './ui/dialog/DialogStack';\nexport * from './ui/dialog/ListAlertDialog';\nexport * from './ui/dialog/ScrollableSelectionDialog';\nexport * from './ui/dialog/SelectionCarouselDialog';\nexport * from './ui/dialog/SelectionDialog';\nexport * from './ui/Alignment';\nexport * from './ui/DialogList';\nexport * from './ui/Render';\n\nexport * from './util/ListUtil';\nexport * from './util/MathUtil';\nexport * from './util/Random';\nexport * from './util/TimeUtil';\n","import { GameObject } from './GameObject';\nimport { Lifecycle } from './Lifecycle';\n\nexport abstract class Component extends Lifecycle {\n  private _gameObject: GameObject | undefined;\n  private started = false;\n\n  public get gameObject(): GameObject {\n    if (!this._gameObject) throw 'Component not attached!';\n    return this._gameObject;\n  }\n\n  public _startIfNeeded() {\n    if (!this.started) {\n      this.started = true;\n      this?.start();\n    }\n  }\n\n  attach(gameObject: GameObject) {\n    this._gameObject = gameObject;\n  }\n}\n","import { Lifecycle } from '../../game/Lifecycle';\nimport { CanvasRenderer } from '../../graphics/CanvasRenderer';\n\nexport class DialogStack extends Lifecycle {\n  private stack: Lifecycle[] = [];\n\n  public push(dialog: Lifecycle): void {\n    dialog.start?.();\n    this.stack.push(dialog);\n  }\n\n  public pop(): Lifecycle | null {\n    return this.stack.pop() ?? null;\n  }\n\n  update = () => {\n    this.getCurrent()?.update?.();\n  };\n\n  draw = (r: CanvasRenderer) => {\n    for (let i = 0; i < this.stack.length; i++) {\n      this.stack[i].draw?.(r);\n    }\n  };\n\n  drawUi = (r: CanvasRenderer) => {\n    for (let i = 0; i < this.stack.length; i++) {\n      this.stack[i].drawUi?.(r);\n    }\n  };\n\n  private getCurrent(): Lifecycle | null {\n    return this.stack[this.stack.length - 1] ?? null;\n  }\n\n  public isEmpty(): boolean {\n    return this.stack.length == 0;\n  }\n\n  public length(): number {\n    return this.stack.length;\n  }\n\n  public clear() {\n    this.stack.length = 0;\n  }\n}\n","class BuildConfig {\n  constructor(public type: 'DEBUG' | 'RELEASE' = 'DEBUG') {}\n}\n\nexport const BUILDCONFIG = new BuildConfig();\n","import { CanvasRenderer } from '../graphics/CanvasRenderer';\nimport { ColorFilter } from '../graphics/ColorFilter';\nimport { RgbColor } from '../graphics/RgbColor';\nimport { BackgroundData } from './BackgroundData';\nimport { instantiate } from './Game';\nimport { GameObject } from './GameObject';\nimport { Lifecycle } from './Lifecycle';\n\nexport abstract class Scene extends Lifecycle {\n  private backgroundColor: RgbColor;\n\n  constructor(\n    public backgroundData?: BackgroundData,\n    public defaultColorFilter?: ColorFilter,\n  ) {\n    super();\n    this.backgroundColor = defaultColorFilter?.get('A') ?? RgbColor.black;\n  }\n\n  public onStart() {\n    if (this.backgroundData) {\n      // Colliders and outer boundaries\n      this.backgroundData.colliders.map((collider) => {\n        const obj = new GameObject('W');\n        obj.x = collider.x;\n        obj.y = collider.y;\n        obj.setDimensions(collider.width, collider.height);\n        obj.ignoresCollision = false;\n        obj.setColliderOffsets(0, 0);\n        instantiate(obj);\n      });\n      const leftBoundary = new GameObject('W');\n      leftBoundary.setDimensions(200, this.backgroundData.tileHeight * 16);\n      leftBoundary.setColliderOffsets(0, 0);\n      leftBoundary.x = -200;\n      instantiate(leftBoundary);\n      const rightBoundary = new GameObject('W');\n      rightBoundary.setDimensions(200, this.backgroundData.tileHeight * 16);\n      rightBoundary.setColliderOffsets(0, 0);\n      rightBoundary.x = this.backgroundData.tileWidth * 16;\n      instantiate(rightBoundary);\n      const topBoundary = new GameObject('W');\n      topBoundary.setDimensions(this.backgroundData.tileWidth * 16 + 400, 200);\n      topBoundary.setColliderOffsets(0, 0);\n      topBoundary.x = -200;\n      topBoundary.y = -200;\n      instantiate(topBoundary);\n      const bottomBoundary = new GameObject('W');\n      bottomBoundary.setDimensions(this.backgroundData.tileWidth * 16 + 400, 200);\n      bottomBoundary.setColliderOffsets(0, 0);\n      bottomBoundary.x = -200;\n      bottomBoundary.y = this.backgroundData.tileHeight * 16;\n      instantiate(bottomBoundary);\n    }\n    this.start();\n  }\n\n  public onDraw(r: CanvasRenderer) {\n    r.fillColor(this.backgroundColor);\n    if (this.backgroundData) {\n      for (let a = 0; a < this.backgroundData.tileHeight; a++) {\n        for (let b = 0; b < this.backgroundData.tileWidth; b++) {\n          const tile = this.backgroundData.tileDataMap[this.backgroundData.tileWidth * a + b];\n          if (tile) {\n            const decoration = tile.getBitmap();\n            if (decoration != null) {\n              r.drawBitmap(b * 16, a * 16, decoration); // TODO animated decoration\n            }\n          }\n        }\n      }\n    }\n    this.draw(r);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { CanvasRenderer } from '../graphics/CanvasRenderer';\n\nexport abstract class Lifecycle {\n  fixedUpdate = () => {};\n  start = () => {};\n  update = () => {};\n  lateUpdate = () => {};\n  draw = (r: CanvasRenderer) => {};\n  drawUi = (r: CanvasRenderer) => {};\n  destroy = () => {};\n}\n","import { INPUT } from '../../game/Input';\nimport { Lifecycle } from '../../game/Lifecycle';\nimport { Bitmap } from '../../graphics/Bitmap';\nimport { CanvasRenderer } from '../../graphics/CanvasRenderer';\nimport { SelectCursor } from '../components/Cursor';\nimport { GraphicSelectionCarousel } from '../components/SelectionCarousel';\nimport { RenderContext } from '../Render';\nimport { Dialog } from './Dialog';\n\nexport class GraphicSelectionCarouselDialog extends Lifecycle {\n  private dialog: Dialog;\n  private carousel: GraphicSelectionCarousel;\n  private scursor = new SelectCursor();\n\n  constructor(\n    public onSelect: (index: number) => void,\n    public onDismiss: () => void,\n    public onRender: (r: CanvasRenderer, index: number, context: RenderContext) => void,\n    maxItems: number,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    topLeftCorner: Bitmap,\n    verticalSidePiece: Bitmap,\n  ) {\n    super();\n    this.dialog = new Dialog(x, y, width, height, topLeftCorner, verticalSidePiece);\n    this.carousel = new GraphicSelectionCarousel(onRender);\n    this.carousel.maxItems = maxItems;\n  }\n\n  update = () => {\n    this.carousel.update();\n\n    if (INPUT.getKeyDown('A')) {\n      this.onSelect(this.carousel.cursorIndex);\n    } else if (INPUT.getKeyDown('B')) {\n      this.onDismiss();\n    }\n  };\n\n  drawUi = (r: CanvasRenderer) => {\n    this.dialog.drawUi(r);\n    const cursorPadding = 9;\n    const context = this.dialog.getRenderContext(cursorPadding, cursorPadding);\n    this.carousel.onRender(r, this.carousel.cursorIndex, context);\n    const cursorB = this.scursor.get();\n    r.drawStaticBitmap(\n      context.startX - cursorB.width,\n      context.startY + context.maxHeight / 2 - cursorB.height / 2,\n      cursorB.flipHorizontally(),\n    );\n    r.drawStaticBitmap(\n      context.startX + context.maxWidth,\n      context.startY + context.maxHeight / 2 - cursorB.height / 2,\n      cursorB,\n    );\n  };\n\n  public reset(): void {\n    this.carousel.cursorIndex = 0;\n  }\n}\n","export class ListUtil {\n  static removeItem<T>(array: T[], remove: T): T[] {\n    return array.filter((value) => value !== remove);\n  }\n}\n","import { GAMEDRIVER } from '../../game/Game';\nimport { INPUT } from '../../game/Input';\nimport { Lifecycle } from '../../game/Lifecycle';\nimport { Bitmap } from '../../graphics/Bitmap';\nimport { CanvasRenderer } from '../../graphics/CanvasRenderer';\nimport { Font } from '../../text/Font';\nimport { Alignment } from '../Alignment';\nimport { Dialog } from './Dialog';\n\nexport class AlertDialog extends Lifecycle {\n  private dialog: Dialog;\n  private margin: number;\n  private x: number;\n  private y: number;\n  private width: number;\n  private height: number;\n\n  constructor(\n    public onDismiss: () => void,\n    public text: string,\n    alignment: Alignment,\n    margin: number,\n    public padding: number,\n    width: number,\n    topLeftCorner: Bitmap,\n    verticalSidePiece: Bitmap,\n    public font: Font,\n    public kerning: number,\n    public lineSpacing: number,\n  ) {\n    super();\n    this.margin = margin;\n    width = width - margin * 2;\n\n    // TODO text align!\n\n    const textSize = font.measureWrapped(\n      text,\n      width - padding * 2 - verticalSidePiece.width * 2,\n      kerning,\n      lineSpacing,\n    );\n    let height = textSize.height + 2 * topLeftCorner.height + 2 * padding;\n    height = Math.ceil(height / verticalSidePiece.height) * verticalSidePiece.height;\n\n    let y = margin;\n    const sh = GAMEDRIVER.current.getRenderProperties().height;\n    if (alignment == Alignment.CENTER) {\n      y = sh / 2 - height / 2;\n    } else if (alignment == Alignment.BOTTOM) {\n      y = sh - height - margin;\n    }\n\n    const sw = GAMEDRIVER.current.getRenderProperties().width;\n    const x = sw / 2 - width / 2;\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n\n    this.dialog = new Dialog(x, y, width, height, topLeftCorner, verticalSidePiece);\n  }\n\n  update = () => {\n    if (INPUT.getKeyDown('A') || INPUT.getKeyDown('B')) {\n      this.onDismiss();\n    }\n  };\n\n  drawUi = (r: CanvasRenderer) => {\n    this.dialog.drawUi(r);\n    const context = this.dialog.getRenderContext(\n      this.padding,\n      this.padding,\n      this.padding,\n      this.padding,\n    );\n    r.drawStaticTextWrapping(\n      this.text,\n      context.startX,\n      context.startY,\n      context.maxWidth,\n      this.font,\n      this.kerning,\n      this.lineSpacing,\n    );\n  };\n\n  public getMargin(): number {\n    return this.margin;\n  }\n\n  public getX(): number {\n    return this.x;\n  }\n\n  public getY(): number {\n    return this.y;\n  }\n\n  public getWidth(): number {\n    return this.width;\n  }\n\n  public getHeight(): number {\n    return this.height;\n  }\n}\n","export class MathUtil {\n  static clamp(value: number, min: number, max: number): number {\n    return Math.min(Math.max(value, min), max);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(8156);\n"],"names":["SelectionDialog","Lifecycle","onSelect","onDismiss","labels","font","kerning","lineHeight","dialog","list","scursor","SelectCursor","cursorIndex","showCursor","constructor","x","y","width","height","topLeftCorner","verticalSidePiece","super","this","Dialog","List","reset","update","INPUT","getKeyDown","length","selectable","drawUi","r","context","getRenderContext","draw","cursorB","get","drawStaticBitmap","startX","startY","ScrollableSelectionDialog","lineSpacing","indicatorAlignment","renderCursorIndex","maxRowCount","ScrollableList","topOffset","targetIndex","i","dir","MathUtil","clamp","calc","calculateRenderCursorIndexTopOffset","labelCount","newRenderCursor","calculateNewRenderCursor","drawList","DestroyTimer","Component","frames","framesLeft","GameObject","destroy","gameObject","Camera","CAMERA","tileWidth","tileHeight","tileDataMap","colliders","BackgroundTile","imgName","getBitmap","Assets","getBitmapByName","animation","animationName","getAnimationByName","b","properties","pixels","cachedRgbArray","Uint8ClampedArray","offscreenCanvas","document","createElement","offscreenCtx","getContext","imageData","canvas","colorLightMap","undefined","Pixels","recalculate","ImageData","setColorLightMap","render","isDirty","setClean","putImageData","ctx","imageSmoothingEnabled","clearRect","scaleFactorX","scaleFactorY","drawImage","toRgbaArray","drawBitmap","bitmap","filter","savedFilter","drawLightBitmap","intensity","drawBitmapCentered","drawLightBitmapCentered","drawStaticBitmapCentered","drawText","text","c","l","oldFilter","drawStaticText","drawLightText","drawStaticLightText","drawTextWrapping","maxWidth","drawStaticTextWrapping","segments","split","currentLine","lineY","segmentIndex","nextSegment","nextLine","measure","trim","clear","strokeStaticRectangle","color","thickness","cornerRadius","strokeRectangle","fillStaticRectangle","fillRectangle","fillStaticLightRectangle","fillLightRectangle","strokeStaticCircle","radius","strokeCircle","strokeLightCircle","strokeStaticArc","startAngle","endAngle","strokeArc","fillArc","fillStaticArc","fillStaticCircle","fillCircle","fillLightCircle","fillStaticLightCircle","strokeStaticOval","xCenter","yCenter","radiusX","radiusY","strokeOval","fillStaticOval","fillOval","strokeLightOval","strokeStaticLightOval","fillLightOval","fillStaticLightOval","fillColor","copy","setStaticPixel","setPixel","drawStaticLine","x1","y1","x2","y2","drawLine","Math","round","getPixelData","Alignment","parse","song","ret","buffer","state","n","d","v","duty","frequency","MusicNotes","Object","keys","push","Note","TextUtil","b64PairInt","value","BASE64","indexOf","encode","notes","s","forEach","intToB64Pair","values","duration","g","slideFrequency","slideGain","floor","gain","Point","vectorMagnitude","sqrt","vectorNormalize","magnitude","subtractPoints","a","getPointAtDistanceAndAngle","angle","angleInRadians","PI","newX","cos","newY","sin","z","GraphicSelectionCarousel","onRender","maxItems","label","alignment","colorString","LEFT","item","m","CENTER","RIGHT","ncursor","NextCursor","iterationCount","startIndex","trueIndex","monoColorFilter","defaultColorFilter","DefaultAssets","ncursor_1","maxHeight","cursorBFlipped","flipVertically","object","location","GAME","current","addObject","destroyObject","objects","pendingAdds","pendingDels","currentScene","scene","onUpdate","adds","start","getComponents","component","_startIfNeeded","fixedUpdate","vx","vy","move","linearDampingX","linearDampingY","abs","lateUpdate","includes","dels","_markDestroyed","onDraw","renderer","sort","az","bz","orderInLayer","DEBUG","colliderOffsetX","colliderOffsetY","DEBUG_COLOR","changeScene","wipe","findObjectByName","name","findObjectById","id","instanceId","getFilteredObjects","onStart","GAMEDRIVER","charMap","fallback","w","h","max","measureWrapped","totalHeight","maxLineWidth","lineCount","static","base64","Error","firstIndex","secondIndex","num","rleimg","rle","data","count","char","parseInt","Bitmap","rle64img","slice","stringToRle","base","curC","toString","letterMapData","map","result","chunkString","Array","from","col","row","InstrumentType","AudioPlayerImpl","audioContext","hasInitializedOscillators","volume","doesRepeat","onDoneListener","currentTrack","instruments","isStillPlayingChannel","songLength","remainingFrames","params","instrument","AudioMixerImpl","instrumentType","SQUARE","SquareInstrument","TRIANGLE","TriangleInstrument","PULSE_D0","PulseInstrument","NOISE_LOW","NoiseInstrument","test","setInstrumentAsDone","getIsDonePlaying","powerOff","getSongLength","getSongRemainingFrames","getCurrentTime","currentTime","getDoesRepeat","setDoesRepeat","getVolume","setVolume","resume","setOnDoneListener","listener","stop","_createPeriodicWave","real","imag","createPeriodicWave","every","setTrack","tracks","AudioParser","reduce","sum","note","window","AudioContext","then","isDestroyed","initializeOscillators","play","catch","error","console","initialize","audioPlayers","playSoundClip","newPlayer","player","stopAll","AUDIO","A_MIXER","AlertChoiceDialog","alertDialog","selectionDialog","textSizes","textHeight","size","ceil","getX","getWidth","getY","frameTime","onLoop","sprites","internalTimer","currentIndex","getCurrentFrame","onEnd","hasEnded","getInternalTimer","setCurrentFrame","frame","lastDirection","getDirection","moved","ns","ew","isDownKey","isUpKey","isLeftKey","isRightKey","direction","Input","isDown","isUp","isLeft","isRight","isA","isB","isC","isD","isZ","isL","isR","lastIsDown","lastIsUp","lastIsLeft","lastIsRight","lastIsA","lastIsB","lastIsC","lastIsD","lastIsZ","lastIsL","lastIsR","key","toLowerCase","getKeyUp","getKey","setUp","setDown","setLeft","setRight","setZ","isZKey","setA","isAKey","setB","isBKey","setC","isCKey","setD","isDKey","ColorLightMap","baseByRgb24","Map","darker","lighter","resolveCache","baseColors","isNone","set","rgb24","resolveCacheByRgb24","resolve","delta","trunc","startRgb24","bucket","cached","sign","steps","cur","idx","RgbColor","black","white","outBucket","clearCache","getAngle","oppositeDirection","getOrthogonalDirections","backgroundColor","topRightCorner","bottomRightCorner","bottomLeftCorner","verticalSidePieceLeft","verticalSidePieceRight","horizontalSidePieceTop","horizontalSidePieceBottom","flipHorizontally","rotate90","getFrameWidth","getFrameHeight","getFrameFullWidth","getFrameFullHeight","paddingLeft","paddingRight","paddingTop","paddingBottom","equals","other","grey","getHexColorString","Collision","unitVectorBetweenObjects","g1","g2","Vector","unitVector","distanceSquaredBetweenObjects","distanceSquared","checkIfRectanglesCollide","w1","h1","w2","h2","checkIfObjectsCollide","obj1","obj2","rect","mask","left","min","right","top","bottom","rows","repeat","newData","flippedData","reverse","join","rotatedData","j","rotatedDataString","newWidth","newHeight","rotate180","rotate270","letterMap","setFilter","getFrame","bitmaps","AnimationSequence","dirty","GameGraphics","createPixelArray","rgbaPixelArray","colorValue","setDirty","bIndex","availableWidth","drawWidth","cx","cy","ColorFilter","gameboyGreyscaleFilter","fallbackColor","dst","lit","endX","endY","yy","xx","drawCirclePixel","err","applyLightAt","lightCirclePixel","rx","ry","stamp","dx","dy","plot4","rx2","ry2","twoRx2","twoRy2","px","py","p1","p2","xMaxByY","fill","mark","ay","xMax","stampLight","halfThickness","drawLineSimple","angleInRange","end","atan2","distance","rawX1","rawY1","rawX2","rawY2","sx","sy","e2","getRawData","game","targetFPS","targetFrameDuration","lastTime","running","loop","bind","getRenderProperties","setRenderer","STEP","performance","now","pause","requestAnimationFrame","timestamp","deltaTime","t","pressUp","liftUp","pressDown","liftDown","pressLeft","liftLeft","pressRight","liftRight","pressZ","liftZ","pressA","liftA","pressB","liftB","pressC","liftC","pressD","liftD","onFinish","startPrimed","maxTime","time","setMaxTime","isRunning","colors","R","C0","CS0","D0","DS0","E0","F0","FS0","G0","GS0","A0","AS0","B0","C1","CS1","D1","DS1","E1","F1","FS1","G1","GS1","A1","AS1","B1","C2","CS2","D2","DS2","E2","F2","FS2","G2","GS2","A2","AS2","B2","C3","CS3","D3","DS3","E3","F3","FS3","G3","GS3","A3","AS3","B3","C4","CS4","D4","DS4","E4","F4","FS4","G4","GS4","A4","AS4","B4","C5","CS5","D5","DS5","E5","F5","FS5","G5","GS5","A5","AS5","B5","C6","CS6","D6","DS6","E6","F6","FS6","G6","GS6","A6","AS6","B6","C7","CS7","D7","DS7","E7","F7","FS7","G7","GS7","A7","AS7","B7","C8","CS8","D8","DS8","E8","F8","FS8","G8","GS8","A8","AS8","B8","C9","CS9","D9","DS9","E9","F9","FS9","G9","GS9","A9","AS9","B9","C10","CS10","D10","DS10","E10","F10","FS10","G10","GS10","A10","AS10","B10","instance","_isDestroyed","red","ignoresCollision","components","setSize","setDimensions","setColliderOffsets","extra","type","addComponent","attach","removeComponent","arg","removed","splice","index","getComponent","find","canCollideWith","nx","ny","walls","go","leftA","rightA","topA","bottomA","leftB","rightB","topB","bottomB","penX","penY","findById","findObjects","instantiate","random","coinflip","randomItem","array","angleBetweenPoints","deltaY","deltaX","degrees","angleBetweenObjects","o1","o2","targetVector","targetX","targetY","pointA","pointB","ncursor_2","scursor_1","scursor_2","formatMilliseconds","milliseconds","totalSeconds","minutes","seconds","String","padStart","assetManager","getFont","getFontByName","getAnimation","getFilter","getFilterByName","getMap","getMapByName","_","none","A","mc1","B","mc2","C","mc3","D","mc4","gs2","gs3","nostalgia4","nostalgia3","nostalgia2","nostalgia1","fromRgbArray","colorMap","ListAlertDialog","padding","margin","sh","BOTTOM","getMargin","getHeight","Instrument","DECAY_STEP","oscillator","waveShaper","currentTimer","playing","initialized","trackLength","loadNote","innerInitialize","innerStart","setGain","setFrequency","powerDown","setTargetAtTime","next","innerLoadNote","createOscillator","createGain","connect","destination","real0","Float32Array","imag0","real1","imag1","real2","imag2","currentDuty","dutyCycle","loadDuty","wave","setPeriodicWave","noise","noiseBuffer","output","disconnect","createBufferSource","createBuffer","sampleRate","getChannelData","createBiquadFilter","_gameObject","started","DialogStack","stack","pop","getCurrent","isEmpty","BUILDCONFIG","Scene","backgroundData","collider","obj","leftBoundary","rightBoundary","topBoundary","bottomBoundary","tile","decoration","GraphicSelectionCarouselDialog","carousel","removeItem","remove","AlertDialog","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call"],"sourceRoot":""}